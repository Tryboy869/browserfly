<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Browserfly - Your AI Agent Lives in the Browser</title>
  <meta name="description" content="Browserfly - Local. Private. Yours. A browser-based AI agent interface supporting multiple cloud providers and local models.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
  <style>
    /* ===== CSS VARIABLES ===== */
    :root {
      --primary: #6C63FF;
      --secondary: #00D4FF;
      --accent: #FF6B9D;
      --bg: #0A0A0F;
      --bg-light: #12121A;
      --bg-lighter: #1A1A25;
      --text: #E8E8FF;
      --text-muted: #8888AA;
      --glass: rgba(108, 99, 255, 0.08);
      --glass-border: rgba(108, 99, 255, 0.3);
      --success: #00E676;
      --warning: #FFB300;
      --error: #FF5252;
      --info: #448AFF;
    }

    /* ===== RESET & BASE ===== */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      line-height: 1.6;
      overflow-x: hidden;
    }

    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* ===== BACKGROUND BUTTERFLIES ===== */
    .bg-butterflies {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    .bg-butterfly {
      position: absolute;
      opacity: 0.15;
      will-change: transform;
    }

    .bg-butterfly svg {
      width: 100%;
      height: 100%;
    }

    @keyframes drift1 {
      0% { transform: translate(-100px, 20vh) rotate(0deg); }
      25% { transform: translate(25vw, 40vh) rotate(90deg); }
      50% { transform: translate(50vw, 60vh) rotate(180deg); }
      75% { transform: translate(75vw, 30vh) rotate(270deg); }
      100% { transform: translate(110vw, 50vh) rotate(360deg); }
    }

    @keyframes drift2 {
      0% { transform: translate(110vw, 10vh) rotate(0deg); }
      33% { transform: translate(60vw, 50vh) rotate(120deg); }
      66% { transform: translate(20vw, 80vh) rotate(240deg); }
      100% { transform: translate(-100px, 30vh) rotate(360deg); }
    }

    @keyframes drift3 {
      0% { transform: translate(50vw, -50px) rotate(0deg); }
      50% { transform: translate(80vw, 50vh) rotate(180deg); }
      100% { transform: translate(20vw, 110vh) rotate(360deg); }
    }

    @keyframes drift4 {
      0% { transform: translate(-50px, 80vh) rotate(0deg); }
      50% { transform: translate(50vw, 40vh) rotate(180deg); }
      100% { transform: translate(110vw, 70vh) rotate(360deg); }
    }

    @keyframes drift5 {
      0% { transform: translate(80vw, 110vh) rotate(0deg); }
      50% { transform: translate(30vw, 50vh) rotate(180deg); }
      100% { transform: translate(60vw, -50px) rotate(360deg); }
    }

    @keyframes drift6 {
      0% { transform: translate(20vw, -50px) rotate(0deg); }
      33% { transform: translate(70vw, 30vh) rotate(120deg); }
      66% { transform: translate(40vw, 70vh) rotate(240deg); }
      100% { transform: translate(90vw, 110vh) rotate(360deg); }
    }

    @keyframes drift7 {
      0% { transform: translate(110vw, 60vh) rotate(0deg); }
      50% { transform: translate(50vw, 20vh) rotate(180deg); }
      100% { transform: translate(-100px, 80vh) rotate(360deg); }
    }

    @keyframes drift8 {
      0% { transform: translate(-100px, 40vh) rotate(0deg); }
      25% { transform: translate(30vw, 70vh) rotate(90deg); }
      50% { transform: translate(60vw, 30vh) rotate(180deg); }
      75% { transform: translate(90vw, 60vh) rotate(270deg); }
      100% { transform: translate(110vw, 20vh) rotate(360deg); }
    }

    @keyframes drift9 {
      0% { transform: translate(40vw, 110vh) rotate(0deg); }
      50% { transform: translate(80vw, 50vh) rotate(180deg); }
      100% { transform: translate(10vw, -50px) rotate(360deg); }
    }

    @keyframes drift10 {
      0% { transform: translate(90vw, -50px) rotate(0deg); }
      33% { transform: translate(20vw, 40vh) rotate(120deg); }
      66% { transform: translate(70vw, 80vh) rotate(240deg); }
      100% { transform: translate(30vw, 110vh) rotate(360deg); }
    }

    @keyframes drift11 {
      0% { transform: translate(-100px, 70vh) rotate(0deg); }
      50% { transform: translate(55vw, 25vh) rotate(180deg); }
      100% { transform: translate(110vw, 55vh) rotate(360deg); }
    }

    @keyframes drift12 {
      0% { transform: translate(65vw, 110vh) rotate(0deg); }
      50% { transform: translate(25vw, 45vh) rotate(180deg); }
      100% { transform: translate(85vw, -50px) rotate(360deg); }
    }

    .bf-1 { width: 40px; height: 32px; animation: drift1 18s linear infinite; }
    .bf-2 { width: 35px; height: 28px; animation: drift2 22s linear infinite; animation-delay: -5s; }
    .bf-3 { width: 45px; height: 36px; animation: drift3 15s linear infinite; animation-delay: -3s; }
    .bf-4 { width: 30px; height: 24px; animation: drift4 20s linear infinite; animation-delay: -8s; }
    .bf-5 { width: 38px; height: 30px; animation: drift5 17s linear infinite; animation-delay: -2s; }
    .bf-6 { width: 42px; height: 34px; animation: drift6 19s linear infinite; animation-delay: -6s; }
    .bf-7 { width: 33px; height: 26px; animation: drift7 21s linear infinite; animation-delay: -4s; }
    .bf-8 { width: 48px; height: 38px; animation: drift8 16s linear infinite; animation-delay: -7s; }
    .bf-9 { width: 36px; height: 29px; animation: drift9 23s linear infinite; animation-delay: -1s; }
    .bf-10 { width: 44px; height: 35px; animation: drift10 14s linear infinite; animation-delay: -9s; }
    .bf-11 { width: 32px; height: 25px; animation: drift11 25s linear infinite; animation-delay: -10s; }
    .bf-12 { width: 50px; height: 40px; animation: drift12 12s linear infinite; animation-delay: -11s; }

    /* ===== HEADER ===== */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 70px;
      background: rgba(10, 10, 15, 0.85);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--glass-border);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 24px;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-svg {
      width: 40px;
      height: 32px;
    }

    .logo-text {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header-nav {
      display: flex;
      gap: 8px;
    }

    .nav-btn {
      padding: 10px 20px;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-family: 'Inter', sans-serif;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s ease;
      position: relative;
    }

    .nav-btn:hover {
      color: var(--text);
      background: var(--glass);
    }

    .nav-btn.active {
      color: var(--text);
      background: var(--glass);
    }

    .nav-btn.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 20%;
      right: 20%;
      height: 2px;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      border-radius: 1px;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .lang-toggle {
      display: flex;
      gap: 4px;
      background: var(--bg-light);
      padding: 4px;
      border-radius: 8px;
    }

    .lang-btn {
      padding: 6px 12px;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      border-radius: 6px;
      transition: all 0.3s ease;
    }

    .lang-btn.active {
      background: var(--primary);
      color: white;
    }

    .status-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--success);
      box-shadow: 0 0 10px var(--success);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(1.1); }
    }

    .mobile-menu-btn {
      display: none;
      flex-direction: column;
      gap: 5px;
      padding: 8px;
      background: transparent;
      border: none;
      cursor: pointer;
    }

    .mobile-menu-btn span {
      width: 24px;
      height: 2px;
      background: var(--text);
      transition: all 0.3s ease;
    }

    /* ===== MAIN CONTENT ===== */
    .main-content {
      padding-top: 70px;
      min-height: 100vh;
      position: relative;
      z-index: 1;
    }

    .tab-content {
      display: none;
      padding: 24px;
      max-width: 1400px;
      margin: 0 auto;
    }

    .tab-content.active {
      display: block;
    }

    /* ===== HERO SECTION ===== */
    .hero {
      text-align: center;
      padding: 60px 24px 40px;
      background: linear-gradient(180deg, rgba(108, 99, 255, 0.05) 0%, transparent 100%);
      position: relative;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: 
        linear-gradient(rgba(108, 99, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(108, 99, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
      pointer-events: none;
    }

    .hero-title {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      margin-bottom: 20px;
    }

    .hero-butterfly {
      width: 80px;
      height: 64px;
      animation: gentlePulse 3s ease-in-out infinite;
    }

    @keyframes gentlePulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .title-text {
      font-family: 'Orbitron', sans-serif;
      font-size: 3rem;
      font-weight: 800;
      display: flex;
    }

    .title-letter {
      opacity: 0;
      animation: letterReveal 0.4s forwards;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .title-letter:nth-child(1) { animation-delay: 0s; }
    .title-letter:nth-child(2) { animation-delay: 0.1s; }
    .title-letter:nth-child(3) { animation-delay: 0.2s; }
    .title-letter:nth-child(4) { animation-delay: 0.3s; }
    .title-letter:nth-child(5) { animation-delay: 0.4s; }
    .title-letter:nth-child(6) { animation-delay: 0.5s; }
    .title-letter:nth-child(7) { animation-delay: 0.6s; }
    .title-letter:nth-child(8) { animation-delay: 0.7s; }
    .title-letter:nth-child(9) { animation-delay: 0.8s; }
    .title-letter:nth-child(10) { animation-delay: 0.9s; }

    @keyframes letterReveal {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .hero-tagline {
      font-size: 1.2rem;
      color: var(--text-muted);
      max-width: 600px;
      margin: 0 auto 32px;
      line-height: 1.8;
    }

    .hero-cta {
      display: flex;
      gap: 16px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn {
      padding: 14px 32px;
      border: none;
      border-radius: 12px;
      font-family: 'Inter', sans-serif;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: white;
      box-shadow: 0 4px 20px rgba(108, 99, 255, 0.4);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 30px rgba(108, 99, 255, 0.5);
    }

    .btn-secondary {
      background: var(--bg-light);
      color: var(--text);
      border: 1px solid var(--glass-border);
    }

    .btn-secondary:hover {
      background: var(--glass);
      border-color: var(--primary);
    }

    .btn-sm {
      padding: 8px 16px;
      font-size: 0.85rem;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* ===== STATS CARDS ===== */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
      margin-bottom: 32px;
    }

    .stat-card {
      background: var(--glass);
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      padding: 24px;
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      border-color: var(--primary);
      transform: translateY(-2px);
    }

    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      margin-bottom: 16px;
    }

    .stat-icon.config { background: rgba(108, 99, 255, 0.2); }
    .stat-icon.models { background: rgba(0, 212, 255, 0.2); }
    .stat-icon.requests { background: rgba(255, 107, 157, 0.2); }
    .stat-icon.storage { background: rgba(0, 230, 118, 0.2); }

    .stat-value {
      font-family: 'Orbitron', sans-serif;
      font-size: 2rem;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    /* ===== PANELS ===== */
    .panel {
      background: var(--glass);
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
    }

    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .panel-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .panel-actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    /* ===== MODEL CARDS ===== */
    .models-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 16px;
    }

    .model-card {
      background: var(--bg-light);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s ease;
      position: relative;
    }

    .model-card:hover {
      border-color: var(--primary);
      transform: translateY(-2px);
    }

    .model-card.primary {
      border-color: var(--success);
      box-shadow: 0 0 20px rgba(0, 230, 118, 0.2);
    }

    .model-card.fallback {
      border-color: var(--warning);
      box-shadow: 0 0 20px rgba(255, 179, 0, 0.2);
    }

    .model-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .model-name {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text);
    }

    .model-badge {
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
    }

    .badge-primary {
      background: rgba(0, 230, 118, 0.2);
      color: var(--success);
    }

    .badge-fallback {
      background: rgba(255, 179, 0, 0.2);
      color: var(--warning);
    }

    .badge-cloud {
      background: rgba(108, 99, 255, 0.2);
      color: var(--primary);
    }

    .badge-local {
      background: rgba(0, 212, 255, 0.2);
      color: var(--secondary);
    }

    .model-meta {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 16px;
    }

    .model-meta-row {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .model-meta-label {
      min-width: 80px;
    }

    .model-meta-value {
      color: var(--text);
    }

    .model-capabilities {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 16px;
    }

    .capability-tag {
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 0.7rem;
      font-weight: 500;
    }

    .cap-chat { background: rgba(68, 138, 255, 0.2); color: #448AFF; }
    .cap-vision { background: rgba(108, 99, 255, 0.2); color: var(--primary); }
    .cap-reasoning { background: rgba(255, 179, 0, 0.2); color: var(--warning); }
    .cap-code { background: rgba(0, 230, 118, 0.2); color: var(--success); }
    .cap-tools { background: rgba(0, 212, 255, 0.2); color: var(--secondary); }
    .cap-context { background: rgba(255, 107, 157, 0.2); color: var(--accent); }
    .cap-fast { background: rgba(178, 255, 89, 0.2); color: #B2FF59; }

    .model-actions {
      display: flex;
      gap: 8px;
    }

    .model-actions .btn {
      flex: 1;
      padding: 10px 16px;
      font-size: 0.8rem;
    }

    /* ===== PROVIDER SECTIONS ===== */
    .provider-section {
      margin-bottom: 32px;
    }

    .provider-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--glass-border);
    }

    .provider-name {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .provider-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }

    .provider-status {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* ===== FORM ELEMENTS ===== */
    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-size: 0.9rem;
      font-weight: 500;
      color: var(--text);
      margin-bottom: 8px;
    }

    .form-input {
      width: 100%;
      padding: 12px 16px;
      background: var(--bg-light);
      border: 1px solid var(--glass-border);
      border-radius: 10px;
      color: var(--text);
      font-family: 'Inter', sans-serif;
      font-size: 0.95rem;
      transition: all 0.3s ease;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.2);
    }

    .form-input::placeholder {
      color: var(--text-muted);
    }

    .input-group {
      display: flex;
      gap: 8px;
    }

    .input-group .form-input {
      flex: 1;
    }

    .input-group .btn {
      white-space: nowrap;
    }

    .form-select {
      width: 100%;
      padding: 12px 16px;
      background: var(--bg-light);
      border: 1px solid var(--glass-border);
      border-radius: 10px;
      color: var(--text);
      font-family: 'Inter', sans-serif;
      font-size: 0.95rem;
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%238888AA' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 16px center;
    }

    .form-select:focus {
      outline: none;
      border-color: var(--primary);
    }

    .form-textarea {
      min-height: 200px;
      resize: vertical;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      line-height: 1.6;
    }

    /* ===== CHECKBOXES ===== */
    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 0;
      cursor: pointer;
    }

    .checkbox-group input[type="checkbox"] {
      width: 20px;
      height: 20px;
      accent-color: var(--primary);
      cursor: pointer;
    }

    .checkbox-label {
      font-size: 0.95rem;
      color: var(--text);
    }

    .checkbox-description {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-left: 32px;
    }

    /* ===== SLIDERS ===== */
    .slider-group {
      margin-bottom: 20px;
    }

    .slider-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .slider-label {
      font-size: 0.9rem;
      color: var(--text);
    }

    .slider-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--primary);
    }

    .slider {
      width: 100%;
      height: 6px;
      -webkit-appearance: none;
      appearance: none;
      background: var(--bg-light);
      border-radius: 3px;
      outline: none;
    }

    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      background: var(--primary);
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 0 10px var(--primary);
    }

    /* ===== SEARCH BAR ===== */
    .search-bar {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .search-input {
      flex: 1;
      min-width: 200px;
    }

    .filter-group {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    /* ===== LOGS ===== */
    .logs-container {
      max-height: 600px;
      overflow-y: auto;
      background: var(--bg-light);
      border-radius: 12px;
      padding: 16px;
    }

    .log-entry {
      padding: 12px;
      border-bottom: 1px solid var(--glass-border);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      display: flex;
      gap: 12px;
      align-items: flex-start;
    }

    .log-entry:last-child {
      border-bottom: none;
    }

    .log-level {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-top: 6px;
      flex-shrink: 0;
    }

    .log-level.info { background: var(--info); }
    .log-level.success { background: var(--success); }
    .log-level.warning { background: var(--warning); }
    .log-level.error { background: var(--error); }
    .log-level.debug { background: var(--text-muted); }

    .log-content {
      flex: 1;
    }

    .log-time {
      color: var(--text-muted);
      font-size: 0.75rem;
    }

    .log-action {
      color: var(--text);
      font-weight: 500;
    }

    .log-details {
      color: var(--text-muted);
      font-size: 0.75rem;
      margin-top: 4px;
    }

    .logs-filter {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .logs-filter .form-select,
    .logs-filter .form-input {
      width: auto;
      min-width: 150px;
    }

    /* ===== PROGRESS BAR ===== */
    .progress-container {
      margin: 16px 0;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 0.85rem;
    }

    .progress-bar {
      height: 8px;
      background: var(--bg-light);
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      border-radius: 4px;
      transition: width 0.3s ease;
    }

    /* ===== CHART CONTAINER ===== */
    .chart-container {
      position: relative;
      height: 300px;
      margin: 20px 0;
    }

    /* ===== ACTIVITY FEED ===== */
    .activity-feed {
      max-height: 400px;
      overflow-y: auto;
    }

    .activity-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      border-bottom: 1px solid var(--glass-border);
    }

    .activity-item:last-child {
      border-bottom: none;
    }

    .activity-icon {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      flex-shrink: 0;
    }

    .activity-content {
      flex: 1;
    }

    .activity-text {
      font-size: 0.9rem;
      color: var(--text);
    }

    .activity-time {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    /* ===== AGENT STATUS BAR ===== */
    .agent-status {
      background: linear-gradient(135deg, rgba(108, 99, 255, 0.15) 0%, rgba(0, 212, 255, 0.15) 100%);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      padding: 16px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 16px;
    }

    .agent-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .agent-avatar {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }

    .agent-details h4 {
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      color: var(--text);
    }

    .agent-details p {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .agent-config {
      display: flex;
      gap: 24px;
      flex-wrap: wrap;
    }

    .agent-config-item {
      text-align: center;
    }

    .agent-config-label {
      font-size: 0.7rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .agent-config-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--text);
      margin-top: 4px;
    }

    /* ===== FOOTER ===== */
    .footer {
      background: var(--bg);
      border-top: 1px solid;
      border-image: linear-gradient(90deg, var(--primary), var(--secondary)) 1;
      padding: 40px 24px 24px;
      margin-top: 40px;
    }

    .footer-content {
      max-width: 1400px;
      margin: 0 auto;
    }

    .footer-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 24px;
      margin-bottom: 24px;
    }

    .footer-left {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .footer-center {
      text-align: center;
    }

    .author-card {
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 12px;
      padding: 16px 24px;
    }

    .author-name {
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      color: var(--text);
      margin-bottom: 4px;
    }

    .author-title {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .author-location {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .author-links {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-top: 12px;
    }

    .author-link {
      color: var(--primary);
      text-decoration: none;
      font-size: 0.8rem;
      transition: color 0.3s ease;
    }

    .author-link:hover {
      color: var(--secondary);
    }

    .footer-right {
      display: flex;
      gap: 20px;
    }

    .footer-link {
      color: var(--text-muted);
      text-decoration: none;
      font-size: 0.9rem;
      transition: color 0.3s ease;
    }

    .footer-link:hover {
      color: var(--text);
    }

    .footer-bottom {
      text-align: center;
      padding-top: 24px;
      border-top: 1px solid var(--glass-border);
    }

    .footer-butterflies {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 16px;
    }

    .footer-butterfly {
      width: 24px;
      height: 20px;
      opacity: 0.5;
    }

    .footer-copyright {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    /* ===== LOADING STATES ===== */
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 40px;
      color: var(--text-muted);
    }

    .spinner {
      width: 20px;
      height: 20px;
      border: 2px solid var(--glass-border);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* ===== EMPTY STATE ===== */
    .empty-state {
      text-align: center;
      padding: 60px 24px;
      color: var(--text-muted);
    }

    .empty-state-icon {
      font-size: 3rem;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .empty-state-title {
      font-size: 1.2rem;
      color: var(--text);
      margin-bottom: 8px;
    }

    /* ===== ALERTS ===== */
    .alert {
      padding: 16px 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .alert-info {
      background: rgba(68, 138, 255, 0.1);
      border: 1px solid rgba(68, 138, 255, 0.3);
      color: #448AFF;
    }

    .alert-success {
      background: rgba(0, 230, 118, 0.1);
      border: 1px solid rgba(0, 230, 118, 0.3);
      color: var(--success);
    }

    .alert-warning {
      background: rgba(255, 179, 0, 0.1);
      border: 1px solid rgba(255, 179, 0, 0.3);
      color: var(--warning);
    }

    .alert-error {
      background: rgba(255, 82, 82, 0.1);
      border: 1px solid rgba(255, 82, 82, 0.3);
      color: var(--error);
    }

    /* ===== TABS WITHIN PANELS ===== */
    .sub-tabs {
      display: flex;
      gap: 4px;
      margin-bottom: 20px;
      border-bottom: 1px solid var(--glass-border);
      padding-bottom: 12px;
    }

    .sub-tab {
      padding: 8px 16px;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-family: 'Inter', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .sub-tab:hover {
      color: var(--text);
      background: var(--glass);
    }

    .sub-tab.active {
      color: var(--text);
      background: var(--glass);
    }

    .sub-tab-content {
      display: none;
    }

    .sub-tab-content.active {
      display: block;
    }

    /* ===== MOBILE RESPONSIVE ===== */
    @media (max-width: 768px) {
      .header-nav {
        display: none;
        position: absolute;
        top: 70px;
        left: 0;
        right: 0;
        background: var(--bg);
        flex-direction: column;
        padding: 16px;
        border-bottom: 1px solid var(--glass-border);
      }

      .header-nav.open {
        display: flex;
      }

      .mobile-menu-btn {
        display: flex;
      }

      .title-text {
        font-size: 2rem;
      }

      .hero-butterfly {
        width: 50px;
        height: 40px;
      }

      .hero-tagline {
        font-size: 1rem;
      }

      .hero-cta {
        flex-direction: column;
      }

      .btn {
        width: 100%;
        justify-content: center;
      }

      .models-grid {
        grid-template-columns: 1fr;
      }

      .agent-status {
        flex-direction: column;
        text-align: center;
      }

      .agent-config {
        justify-content: center;
      }

      .footer-top {
        flex-direction: column;
        text-align: center;
      }

      .footer-right {
        justify-content: center;
      }
    }

    @media (max-width: 480px) {
      .header {
        padding: 0 16px;
      }

      .logo-text {
        font-size: 1.2rem;
      }

      .title-text {
        font-size: 1.5rem;
      }

      .tab-content {
        padding: 16px;
      }

      .panel {
        padding: 16px;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }
    }

    /* ===== SCROLLBAR ===== */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-light);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--glass-border);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--primary);
    }

    /* ===== SELECTION ===== */
    ::selection {
      background: rgba(108, 99, 255, 0.3);
      color: var(--text);
    }
  </style>
</head>
<body>
  <!-- Background Butterflies -->
  <div class="bg-butterflies" id="bgButterflies"></div>

  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <svg class="logo-svg" viewBox="0 0 200 160" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="wingGrad" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#6C63FF"/>
            <stop offset="100%" style="stop-color:#00D4FF"/>
          </linearGradient>
          <linearGradient id="wingGradLower" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#FF6B9D"/>
            <stop offset="100%" style="stop-color:#6C63FF"/>
          </linearGradient>
          <filter id="glow">
            <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
            <feMerge>
              <feMergeNode in="coloredBlur"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>
        </defs>
        <g id="left-wing">
          <animateTransform attributeName="transform" type="rotate"
            values="-15,100,80; 0,100,80; -15,100,80"
            dur="1.8s" repeatCount="indefinite"/>
          <path d="M100,80 Q60,20 20,40 Q10,60 30,80 Q10,100 30,120 Q60,140 100,80" 
            fill="url(#wingGrad)" filter="url(#glow)" opacity="0.9"/>
          <path d="M100,80 Q70,100 50,130 Q60,145 80,140 Q95,120 100,80" 
            fill="url(#wingGradLower)" filter="url(#glow)" opacity="0.8"/>
        </g>
        <g id="right-wing">
          <animateTransform attributeName="transform" type="rotate"
            values="15,100,80; 0,100,80; 15,100,80"
            dur="1.8s" begin="0.2s" repeatCount="indefinite"/>
          <path d="M100,80 Q140,20 180,40 Q190,60 170,80 Q190,100 170,120 Q140,140 100,80" 
            fill="url(#wingGrad)" filter="url(#glow)" opacity="0.9"/>
          <path d="M100,80 Q130,100 150,130 Q140,145 120,140 Q105,120 100,80" 
            fill="url(#wingGradLower)" filter="url(#glow)" opacity="0.8"/>
        </g>
        <ellipse cx="100" cy="80" rx="6" ry="40" fill="#1A1A25" filter="url(#glow)"/>
        <path d="M100,45 Q85,25 80,15" stroke="#6C63FF" stroke-width="2" fill="none" opacity="0.7">
          <animate attributeName="d" values="M100,45 Q85,25 80,15;M100,45 Q82,28 78,18;M100,45 Q85,25 80,15" dur="2s" repeatCount="indefinite"/>
        </path>
        <path d="M100,45 Q115,25 120,15" stroke="#6C63FF" stroke-width="2" fill="none" opacity="0.7">
          <animate attributeName="d" values="M100,45 Q115,25 120,15;M100,45 Q118,28 122,18;M100,45 Q115,25 120,15" dur="2s" begin="0.3s" repeatCount="indefinite"/>
        </path>
        <circle cx="80" cy="15" r="3" fill="#00D4FF">
          <animate attributeName="opacity" values="1;0.5;1" dur="1.5s" repeatCount="indefinite"/>
        </circle>
        <circle cx="120" cy="15" r="3" fill="#00D4FF">
          <animate attributeName="opacity" values="1;0.5;1" dur="1.5s" begin="0.5s" repeatCount="indefinite"/>
        </circle>
      </svg>
      <span class="logo-text">Browserfly</span>
    </div>
    <nav class="header-nav" id="headerNav">
      <button class="nav-btn active" data-tab="dashboard" data-i18n="nav.dashboard">Dashboard</button>
      <button class="nav-btn" data-tab="models" data-i18n="nav.models">Models</button>
      <button class="nav-btn" data-tab="config" data-i18n="nav.config">Configuration</button>
      <button class="nav-btn" data-tab="logs" data-i18n="nav.logs">Activity Logs</button>
    </nav>
    <div class="header-right">
      <div class="lang-toggle">
        <button class="lang-btn active" data-lang="en">EN</button>
        <button class="lang-btn" data-lang="fr">FR</button>
      </div>
      <div class="status-dot" title="System Active"></div>
      <button class="mobile-menu-btn" id="mobileMenuBtn">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Dashboard Tab -->
    <div class="tab-content active" id="dashboard-tab">
      <section class="hero">
        <div class="hero-title">
          <svg class="hero-butterfly" viewBox="0 0 200 160" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="heroWingGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#6C63FF"/>
                <stop offset="100%" style="stop-color:#00D4FF"/>
              </linearGradient>
              <linearGradient id="heroWingGradLower" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#FF6B9D"/>
                <stop offset="100%" style="stop-color:#6C63FF"/>
              </linearGradient>
              <filter id="heroGlow">
                <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                <feMerge>
                  <feMergeNode in="coloredBlur"/>
                  <feMergeNode in="SourceGraphic"/>
                </feMerge>
              </filter>
              <radialGradient id="bgGlow" cx="50%" cy="50%" r="50%">
                <stop offset="0%" style="stop-color:#6C63FF;stop-opacity:0.3"/>
                <stop offset="100%" style="stop-color:#6C63FF;stop-opacity:0"/>
              </radialGradient>
            </defs>
            <circle cx="100" cy="80" r="70" fill="url(#bgGlow)"/>
            <g>
              <animateTransform attributeName="transform" type="rotate"
                values="-20,100,80; 0,100,80; -20,100,80"
                dur="1.5s" repeatCount="indefinite"/>
              <path d="M100,80 Q50,10 10,35 Q0,60 25,80 Q0,100 25,120 Q50,150 100,80" 
                fill="url(#heroWingGrad)" filter="url(#heroGlow)" opacity="0.95"/>
              <path d="M100,80 Q65,105 45,140 Q55,155 80,150 Q95,125 100,80" 
                fill="url(#heroWingGradLower)" filter="url(#heroGlow)" opacity="0.85"/>
            </g>
            <g>
              <animateTransform attributeName="transform" type="rotate"
                values="20,100,80; 0,100,80; 20,100,80"
                dur="1.5s" begin="0.15s" repeatCount="indefinite"/>
              <path d="M100,80 Q150,10 190,35 Q200,60 175,80 Q200,100 175,120 Q150,150 100,80" 
                fill="url(#heroWingGrad)" filter="url(#heroGlow)" opacity="0.95"/>
              <path d="M100,80 Q135,105 155,140 Q145,155 120,150 Q105,125 100,80" 
                fill="url(#heroWingGradLower)" filter="url(#heroGlow)" opacity="0.85"/>
            </g>
            <ellipse cx="100" cy="80" rx="8" ry="50" fill="#0A0A0F" filter="url(#heroGlow)"/>
            <path d="M100,35 Q80,10 75,0" stroke="#6C63FF" stroke-width="3" fill="none" opacity="0.8">
              <animate attributeName="d" values="M100,35 Q80,10 75,0;M100,35 Q77,13 72,3;M100,35 Q80,10 75,0" dur="1.8s" repeatCount="indefinite"/>
            </path>
            <path d="M100,35 Q120,10 125,0" stroke="#6C63FF" stroke-width="3" fill="none" opacity="0.8">
              <animate attributeName="d" values="M100,35 Q120,10 125,0;M100,35 Q123,13 128,3;M100,35 Q120,10 125,0" dur="1.8s" begin="0.2s" repeatCount="indefinite"/>
            </path>
            <circle cx="75" cy="0" r="4" fill="#00D4FF">
              <animate attributeName="opacity" values="1;0.4;1" dur="1.2s" repeatCount="indefinite"/>
            </circle>
            <circle cx="125" cy="0" r="4" fill="#00D4FF">
              <animate attributeName="opacity" values="1;0.4;1" dur="1.2s" begin="0.4s" repeatCount="indefinite"/>
            </circle>
          </svg>
          <h1 class="title-text">
            <span class="title-letter">B</span>
            <span class="title-letter">r</span>
            <span class="title-letter">o</span>
            <span class="title-letter">w</span>
            <span class="title-letter">s</span>
            <span class="title-letter">e</span>
            <span class="title-letter">r</span>
            <span class="title-letter">f</span>
            <span class="title-letter">l</span>
            <span class="title-letter">y</span>
          </h1>
        </div>
        <p class="hero-tagline" data-i18n="hero.tagline">Your AI agent lives in the browser. Local. Private. Yours.</p>
        <div class="hero-cta">
          <button class="btn btn-primary" onclick="app.switchTab('config')" data-i18n="hero.cta.start">Get Started</button>
          <button class="btn btn-secondary" onclick="app.switchTab('models')" data-i18n="hero.cta.models">View Models</button>
        </div>
      </section>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon config">üîß</div>
          <div class="stat-value" id="statProviders">0</div>
          <div class="stat-label" data-i18n="stats.providers">Providers Configured</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon models">ü§ñ</div>
          <div class="stat-value" id="statModels">0</div>
          <div class="stat-label" data-i18n="stats.models">Models Available</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon requests">üìä</div>
          <div class="stat-value" id="statRequests">0</div>
          <div class="stat-label" data-i18n="stats.requests">Total Requests</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon storage">üíæ</div>
          <div class="stat-value" id="statStorage">0 MB</div>
          <div class="stat-label" data-i18n="stats.storage">Storage Used</div>
        </div>
      </div>

      <div class="panel">
        <div class="panel-header">
          <h3 class="panel-title">üìà <span data-i18n="dashboard.requestsChart">Requests Over Time</span></h3>
        </div>
        <div class="chart-container">
          <canvas id="requestsChart"></canvas>
        </div>
      </div>

      <div class="panel">
        <div class="panel-header">
          <h3 class="panel-title">üïê <span data-i18n="dashboard.recentActivity">Recent Activity</span></h3>
        </div>
        <div class="activity-feed" id="activityFeed">
          <div class="empty-state">
            <div class="empty-state-icon">üìã</div>
            <div class="empty-state-title" data-i18n="logs.empty">No logs yet. Start using Browserfly!</div>
          </div>
        </div>
      </div>

      <div class="agent-status">
        <div class="agent-info">
          <div class="agent-avatar">ü¶ã</div>
          <div class="agent-details">
            <h4>Fly <span data-i18n="agent.agent">(Agent)</span> ‚Äî <span style="color: var(--success);" data-i18n="status.active">ACTIVE</span></h4>
            <p><span data-i18n="agent.mode">Mode</span>: <span id="agentMode">Auto-routing</span> | <span data-i18n="agent.privacy">Privacy</span>: <span id="agentPrivacy">ON</span> | <span data-i18n="agent.workers">Workers</span>: 2 <span data-i18n="agent.active">active</span></p>
          </div>
        </div>
        <div class="agent-config">
          <div class="agent-config-item">
            <div class="agent-config-label" data-i18n="agent.primary">Primary</div>
            <div class="agent-config-value" id="agentPrimary">‚Äî</div>
          </div>
          <div class="agent-config-item">
            <div class="agent-config-label" data-i18n="agent.fallback">Fallback</div>
            <div class="agent-config-value" id="agentFallback">‚Äî</div>
          </div>
          <div class="agent-config-item">
            <div class="agent-config-label" data-i18n="agent.local">Local</div>
            <div class="agent-config-value" id="agentLocal">‚Äî</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Models Tab -->
    <div class="tab-content" id="models-tab">
      <div class="panel">
        <div class="sub-tabs">
          <button class="sub-tab active" data-subtab="cloud" data-i18n="models.cloud.title">Cloud AI Providers</button>
          <button class="sub-tab" data-subtab="local" data-i18n="models.local.title">Local Models (HuggingFace)</button>
        </div>

        <!-- Cloud Providers Subtab -->
        <div class="sub-tab-content active" id="cloud-subtab">
          <div id="cloudProvidersContainer">
            <!-- Provider sections will be generated by JS -->
          </div>
        </div>

        <!-- Local Models Subtab -->
        <div class="sub-tab-content" id="local-subtab">
          <div class="search-bar">
            <input type="text" class="form-input search-input" id="hfSearchInput" placeholder="Search HuggingFace models...">
            <div class="filter-group">
              <select class="form-select" id="hfTaskFilter">
                <option value="">All Tasks</option>
                <option value="text-generation">Text Generation</option>
                <option value="text2text-generation">Text2Text</option>
                <option value="automatic-speech-recognition">Speech Recognition</option>
                <option value="image-to-text">Vision</option>
              </select>
              <select class="form-select" id="hfSizeFilter">
                <option value="">All Sizes</option>
                <option value="tiny">&lt;1GB (Tiny)</option>
                <option value="small">1-4GB (Small)</option>
                <option value="medium">4-8GB (Medium)</option>
                <option value="large">&gt;8GB (Large)</option>
              </select>
              <button class="btn btn-primary btn-sm" id="hfSearchBtn" data-i18n="models.search">Search</button>
            </div>
          </div>

          <div class="panel" id="hfRecommendedPanel">
            <div class="panel-header">
              <h4 class="panel-title">‚≠ê <span data-i18n="models.recommended">Recommended Models</span></h4>
            </div>
            <div class="models-grid" id="recommendedModels">
              <!-- Recommended models will be generated by JS -->
            </div>
          </div>

          <div id="hfSearchResults">
            <!-- Search results will be generated by JS -->
          </div>
        </div>
      </div>
    </div>

    <!-- Configuration Tab -->
    <div class="tab-content" id="config-tab">
      <div class="sub-tabs">
        <button class="sub-tab active" data-subtab="apikeys" data-i18n="config.api_keys">API Keys</button>
        <button class="sub-tab" data-subtab="routing" data-i18n="config.routing">Routing Rules</button>
        <button class="sub-tab" data-subtab="localmodel" data-i18n="config.local_model">Local Model</button>
        <button class="sub-tab" data-subtab="integrations" data-i18n="config.integrations">Integrations</button>
        <button class="sub-tab" data-subtab="soul" data-i18n="config.soul">Soul File</button>
      </div>

      <!-- API Keys Subtab -->
      <div class="sub-tab-content active" id="apikeys-subtab">
        <div class="panel">
          <div class="panel-header">
            <h3 class="panel-title">üîë <span data-i18n="config.api_keys">API Keys</span></h3>
          </div>
          <div id="apiKeysContainer">
            <!-- API key inputs will be generated by JS -->
          </div>
          <button class="btn btn-secondary" id="addCustomProvider" data-i18n="config.addCustom">+ Add Custom Provider</button>
        </div>
      </div>

      <!-- Routing Subtab -->
      <div class="sub-tab-content" id="routing-subtab">
        <div class="panel">
          <div class="panel-header">
            <h3 class="panel-title">üîÑ <span data-i18n="config.routing">Cloud Routing</span></h3>
          </div>
          <div class="form-group">
            <label class="form-label" data-i18n="config.primaryProvider">Primary Provider</label>
            <div class="input-group">
              <select class="form-select" id="primaryProvider">
                <option value="">Select Provider</option>
              </select>
              <select class="form-select" id="primaryModel">
                <option value="">Select Model</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label" data-i18n="config.fallbackProvider">Fallback Provider</label>
            <div class="input-group">
              <select class="form-select" id="fallbackProvider">
                <option value="">Select Provider</option>
              </select>
              <select class="form-select" id="fallbackModel">
                <option value="">Select Model</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label" data-i18n="config.autoRouting">Auto-routing Rules</label>
            <label class="checkbox-group">
              <input type="checkbox" id="privacyMode">
              <span class="checkbox-label" data-i18n="config.privacyMode">Privacy mode ‚Üí Always use local model</span>
            </label>
            <p class="checkbox-description" data-i18n="config.privacyModeDesc">When enabled, all requests are processed locally</p>
            <label class="checkbox-group">
              <input type="checkbox" id="complexityThreshold" checked>
              <span class="checkbox-label" data-i18n="config.complexityThreshold">Complexity threshold ‚Üí Cloud if score > 7/10</span>
            </label>
            <label class="checkbox-group">
              <input type="checkbox" id="fallbackOnError" checked>
              <span class="checkbox-label" data-i18n="config.fallbackOnError">Fallback on error ‚Üí Switch to fallback provider</span>
            </label>
            <label class="checkbox-group">
              <input type="checkbox" id="forceLocal">
              <span class="checkbox-label" data-i18n="config.forceLocal">Force local ‚Üí Always use local (offline mode)</span>
            </label>
          </div>
          <div class="form-group">
            <label class="form-label" data-i18n="config.complexityWeights">Complexity Scoring Weights</label>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label" data-i18n="config.reasoning">Requires Reasoning</span>
                <span class="slider-value" id="reasoningValue">+4</span>
              </div>
              <input type="range" class="slider" id="reasoningWeight" min="0" max="10" value="4">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label" data-i18n="config.multiStep">Multi-step Task</span>
                <span class="slider-value" id="multiStepValue">+3</span>
              </div>
              <input type="range" class="slider" id="multiStepWeight" min="0" max="10" value="3">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label" data-i18n="config.domainSpecific">Domain-specific</span>
                <span class="slider-value" id="domainValue">+3</span>
              </div>
              <input type="range" class="slider" id="domainWeight" min="0" max="10" value="3">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label" data-i18n="config.personalData">Contains Personal Data</span>
                <span class="slider-value" id="personalValue">+5</span>
              </div>
              <input type="range" class="slider" id="personalWeight" min="0" max="10" value="5">
            </div>
          </div>
          <button class="btn btn-primary" id="saveRoutingConfig" data-i18n="config.save">Save Configuration</button>
        </div>
      </div>

      <!-- Local Model Subtab -->
      <div class="sub-tab-content" id="localmodel-subtab">
        <div class="panel">
          <div class="panel-header">
            <h3 class="panel-title">üè† <span data-i18n="config.local_model">Local Model</span></h3>
          </div>
          <div class="form-group">
            <label class="form-label" data-i18n="config.activeLocalModel">Active Local Model</label>
            <select class="form-select" id="activeLocalModel">
              <option value="">No local model selected</option>
            </select>
          </div>
          <div id="localModelStatus" class="alert alert-info" style="display: none;">
            <span id="localModelStatusText"></span>
          </div>
          <div class="panel" style="margin-top: 20px;">
            <div class="panel-header">
              <h4 class="panel-title" data-i18n="config.installedModels">Installed Models</h4>
            </div>
            <div id="installedModelsList">
              <div class="empty-state">
                <div class="empty-state-icon">üì¶</div>
                <div class="empty-state-title" data-i18n="config.noInstalledModels">No models installed</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Integrations Subtab -->
      <div class="sub-tab-content" id="integrations-subtab">
        <div class="panel">
          <div class="panel-header">
            <h3 class="panel-title">üîó <span data-i18n="config.integrations">Integrations</span></h3>
          </div>
          <div class="form-group">
            <label class="form-label">Telegram Bot</label>
            <div class="input-group">
              <input type="password" class="form-input" id="telegramToken" placeholder="Bot Token">
              <button class="btn btn-secondary btn-sm" data-i18n="config.verify">Verify</button>
            </div>
            <p class="checkbox-description" id="telegramStatus" data-i18n="config.notConnected">Not connected</p>
          </div>
          <div class="form-group">
            <label class="form-label">GitHub</label>
            <div class="input-group">
              <input type="password" class="form-input" id="githubToken" placeholder="Personal Access Token">
              <button class="btn btn-secondary btn-sm" data-i18n="config.verify">Verify</button>
            </div>
            <p class="checkbox-description" id="githubStatus" data-i18n="config.notConnected">Not connected</p>
          </div>
          <div class="form-group">
            <label class="form-label">Notion</label>
            <button class="btn btn-secondary" data-i18n="config.configure">Configure</button>
          </div>
          <div class="form-group">
            <label class="form-label">Discord</label>
            <button class="btn btn-secondary" data-i18n="config.configure">Configure</button>
          </div>
          <div class="form-group">
            <label class="form-label">Slack</label>
            <button class="btn btn-secondary" data-i18n="config.configure">Configure</button>
          </div>
        </div>
      </div>

      <!-- Soul File Subtab -->
      <div class="sub-tab-content" id="soul-subtab">
        <div class="panel">
          <div class="panel-header">
            <h3 class="panel-title">‚ú® <span data-i18n="config.soul">Soul File</span></h3>
            <div class="panel-actions">
              <button class="btn btn-secondary btn-sm" id="resetSoulFile" data-i18n="config.reset">Reset to Default</button>
              <button class="btn btn-primary btn-sm" id="saveSoulFile" data-i18n="config.save">Save</button>
            </div>
          </div>
          <textarea class="form-input form-textarea" id="soulFileEditor"></textarea>
        </div>
      </div>
    </div>

    <!-- Activity Logs Tab -->
    <div class="tab-content" id="logs-tab">
      <div class="panel">
        <div class="panel-header">
          <h3 class="panel-title">üìã <span data-i18n="logs.title">Activity Logs</span></h3>
          <div class="panel-actions">
            <button class="btn btn-secondary btn-sm" id="exportLogs" data-i18n="logs.export">Export CSV</button>
            <button class="btn btn-secondary btn-sm" id="clearLogs" data-i18n="logs.clear">Clear All</button>
          </div>
        </div>
        <div class="logs-filter">
          <select class="form-select" id="logLevelFilter">
            <option value="" data-i18n="logs.filterAll">All Levels</option>
            <option value="info">Info</option>
            <option value="success">Success</option>
            <option value="warning">Warning</option>
            <option value="error">Error</option>
            <option value="debug">Debug</option>
          </select>
          <input type="text" class="form-input" id="logSearch" placeholder="Search logs..." data-i18n-placeholder="logs.search">
          <input type="date" class="form-input" id="logDateFrom">
          <input type="date" class="form-input" id="logDateTo">
        </div>
        <div class="logs-container" id="logsContainer">
          <div class="empty-state">
            <div class="empty-state-icon">üìã</div>
            <div class="empty-state-title" data-i18n="logs.empty">No logs yet. Start using Browserfly!</div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-top">
        <div class="footer-left">
          <strong>Browserfly v1.0.0</strong> ‚Äî MIT License
        </div>
        <div class="footer-center">
          <div class="author-card">
            <div class="author-name">üåå Daouda Abdoul Anzize</div>
            <div class="author-title">Computational Paradigm Designer</div>
            <div class="author-location">Cotonou, B√©nin ‚Üí Global Remote</div>
            <div class="author-links">
              <a href="https://github.com/tryboy869" class="author-link" target="_blank">GitHub</a>
              <a href="https://twitter.com/Nexusstudio100" class="author-link" target="_blank">Twitter/X</a>
              <a href="mailto:anzizecontact@proton.me" class="author-link">Email</a>
            </div>
          </div>
        </div>
        <div class="footer-right">
          <a href="https://github.com/tryboy869/browserfly" class="footer-link" target="_blank">GitHub</a>
          <a href="#" class="footer-link" onclick="app.switchTab('config')">Docs</a>
          <a href="https://github.com/tryboy869/browserfly/issues" class="footer-link" target="_blank">Report Bug</a>
        </div>
      </div>
      <div class="footer-bottom">
        <div class="footer-butterflies">
          <svg class="footer-butterfly" viewBox="0 0 200 160" xmlns="http://www.w3.org/2000/svg">
            <path d="M100,80 Q60,20 20,40 Q10,60 30,80 Q10,100 30,120 Q60,140 100,80" fill="#6C63FF" opacity="0.5"/>
            <path d="M100,80 Q140,20 180,40 Q190,60 170,80 Q190,100 170,120 Q140,140 100,80" fill="#6C63FF" opacity="0.5"/>
          </svg>
          <svg class="footer-butterfly" viewBox="0 0 200 160" xmlns="http://www.w3.org/2000/svg">
            <path d="M100,80 Q60,20 20,40 Q10,60 30,80 Q10,100 30,120 Q60,140 100,80" fill="#00D4FF" opacity="0.5"/>
            <path d="M100,80 Q140,20 180,40 Q190,60 170,80 Q190,100 170,120 Q140,140 100,80" fill="#00D4FF" opacity="0.5"/>
          </svg>
          <svg class="footer-butterfly" viewBox="0 0 200 160" xmlns="http://www.w3.org/2000/svg">
            <path d="M100,80 Q60,20 20,40 Q10,60 30,80 Q10,100 30,120 Q60,140 100,80" fill="#FF6B9D" opacity="0.5"/>
            <path d="M100,80 Q140,20 180,40 Q190,60 170,80 Q190,100 170,120 Q140,140 100,80" fill="#FF6B9D" opacity="0.5"/>
          </svg>
          <svg class="footer-butterfly" viewBox="0 0 200 160" xmlns="http://www.w3.org/2000/svg">
            <path d="M100,80 Q60,20 20,40 Q10,60 30,80 Q10,100 30,120 Q60,140 100,80" fill="#6C63FF" opacity="0.5"/>
            <path d="M100,80 Q140,20 180,40 Q190,60 170,80 Q190,100 170,120 Q140,140 100,80" fill="#6C63FF" opacity="0.5"/>
          </svg>
          <svg class="footer-butterfly" viewBox="0 0 200 160" xmlns="http://www.w3.org/2000/svg">
            <path d="M100,80 Q60,20 20,40 Q10,60 30,80 Q10,100 30,120 Q60,140 100,80" fill="#00D4FF" opacity="0.5"/>
            <path d="M100,80 Q140,20 180,40 Q190,60 170,80 Q190,100 170,120 Q140,140 100,80" fill="#00D4FF" opacity="0.5"/>
          </svg>
        </div>
        <div class="footer-copyright">
          ¬© 2026 Browserfly ‚Äî Built with ü¶ã by Daouda Abdoul Anzize (Nexus Studio)
        </div>
      </div>
    </div>
  </footer>

  <script>

    // ===== TRANSLATIONS =====
    const TRANSLATIONS = {
      en: {
        'nav.dashboard': 'Dashboard',
        'nav.models': 'Models',
        'nav.config': 'Configuration',
        'nav.logs': 'Activity Logs',
        'hero.tagline': 'Your AI agent lives in the browser. Local. Private. Yours.',
        'hero.cta.start': 'Get Started',
        'hero.cta.models': 'View Models',
        'stats.providers': 'Providers Configured',
        'stats.models': 'Models Available',
        'stats.requests': 'Total Requests',
        'stats.storage': 'Storage Used',
        'dashboard.requestsChart': 'Requests Over Time',
        'dashboard.recentActivity': 'Recent Activity',
        'logs.empty': 'No logs yet. Start using Browserfly!',
        'agent.agent': '(Agent)',
        'agent.mode': 'Mode',
        'agent.privacy': 'Privacy',
        'agent.workers': 'Workers',
        'agent.active': 'active',
        'agent.primary': 'Primary',
        'agent.fallback': 'Fallback',
        'agent.local': 'Local',
        'status.active': 'ACTIVE',
        'models.cloud.title': 'Cloud AI Providers',
        'models.local.title': 'Local Models (HuggingFace)',
        'models.fetch': 'Fetch Models',
        'models.fetching': 'Fetching...',
        'models.no_key': 'Add API key in Configuration to fetch models',
        'models.download': 'Download Locally',
        'models.downloading': 'Downloading...',
        'models.set_primary': 'Set as Primary',
        'models.set_fallback': 'Set as Fallback',
        'models.context': 'Context',
        'models.speed': 'Speed',
        'models.cost': 'Cost',
        'models.search': 'Search',
        'models.recommended': 'Recommended Models',
        'config.api_keys': 'API Keys',
        'config.routing': 'Routing Rules',
        'config.local_model': 'Local Model',
        'config.integrations': 'Integrations',
        'config.soul': 'Soul File',
        'config.save': 'Save',
        'config.verify': 'Verify',
        'config.delete': 'Delete',
        'config.addCustom': '+ Add Custom Provider',
        'config.primaryProvider': 'Primary Provider',
        'config.fallbackProvider': 'Fallback Provider',
        'config.autoRouting': 'Auto-routing Rules',
        'config.privacyMode': 'Privacy mode ‚Üí Always use local model',
        'config.privacyModeDesc': 'When enabled, all requests are processed locally',
        'config.complexityThreshold': 'Complexity threshold ‚Üí Cloud if score > 7/10',
        'config.fallbackOnError': 'Fallback on error ‚Üí Switch to fallback provider',
        'config.forceLocal': 'Force local ‚Üí Always use local (offline mode)',
        'config.complexityWeights': 'Complexity Scoring Weights',
        'config.reasoning': 'Requires Reasoning',
        'config.multiStep': 'Multi-step Task',
        'config.domainSpecific': 'Domain-specific',
        'config.personalData': 'Contains Personal Data',
        'config.activeLocalModel': 'Active Local Model',
        'config.installedModels': 'Installed Models',
        'config.noInstalledModels': 'No models installed',
        'config.notConnected': 'Not connected',
        'config.configure': 'Configure',
        'config.reset': 'Reset to Default',
        'logs.title': 'Activity Logs',
        'logs.filter': 'Filter',
        'logs.filterAll': 'All Levels',
        'logs.export': 'Export CSV',
        'logs.clear': 'Clear All',
        'logs.search': 'Search logs...',
        'status.ready': 'Ready',
        'status.error': 'Error',
        'status.loading': 'Loading...',
        'status.valid': 'Valid',
        'status.invalid': 'Invalid',
        'model.ram.any': 'Runs on any device',
        'model.ram.4gb': 'Needs 4GB+ RAM',
        'model.ram.8gb': 'Needs 8GB+ RAM / GPU recommended',
        'model.ram.gpu': 'GPU required'
      },
      fr: {
        'nav.dashboard': 'Tableau de bord',
        'nav.models': 'Mod√®les',
        'nav.config': 'Configuration',
        'nav.logs': 'Journaux d\'activit√©',
        'hero.tagline': 'Votre agent IA vit dans le navigateur. Local. Priv√©. √Ä vous.',
        'hero.cta.start': 'Commencer',
        'hero.cta.models': 'Voir les mod√®les',
        'stats.providers': 'Fournisseurs Configur√©s',
        'stats.models': 'Mod√®les Disponibles',
        'stats.requests': 'Requ√™tes Totales',
        'stats.storage': 'Stockage Utilis√©',
        'dashboard.requestsChart': 'Requ√™tes dans le Temps',
        'dashboard.recentActivity': 'Activit√© R√©cente',
        'logs.empty': 'Aucun journal. Commencez √† utiliser Browserfly !',
        'agent.agent': '(Agent)',
        'agent.mode': 'Mode',
        'agent.privacy': 'Confidentialit√©',
        'agent.workers': 'Workers',
        'agent.active': 'actifs',
        'agent.primary': 'Principal',
        'agent.fallback': 'Secours',
        'agent.local': 'Local',
        'status.active': 'ACTIF',
        'models.cloud.title': 'Fournisseurs IA Cloud',
        'models.local.title': 'Mod√®les Locaux (HuggingFace)',
        'models.fetch': 'R√©cup√©rer les Mod√®les',
        'models.fetching': 'Chargement...',
        'models.no_key': 'Ajoutez une cl√© API dans Configuration pour voir les mod√®les',
        'models.download': 'T√©l√©charger en Local',
        'models.downloading': 'T√©l√©chargement...',
        'models.set_primary': 'D√©finir comme Principal',
        'models.set_fallback': 'D√©finir comme Secours',
        'models.context': 'Contexte',
        'models.speed': 'Vitesse',
        'models.cost': 'Co√ªt',
        'models.search': 'Rechercher',
        'models.recommended': 'Mod√®les Recommand√©s',
        'config.api_keys': 'Cl√©s API',
        'config.routing': 'R√®gles de Routage',
        'config.local_model': 'Mod√®le Local',
        'config.integrations': 'Int√©grations',
        'config.soul': 'Fichier Soul',
        'config.save': 'Enregistrer',
        'config.verify': 'V√©rifier',
        'config.delete': 'Supprimer',
        'config.addCustom': '+ Ajouter Fournisseur Personnalis√©',
        'config.primaryProvider': 'Fournisseur Principal',
        'config.fallbackProvider': 'Fournisseur de Secours',
        'config.autoRouting': 'R√®gles de Routage Auto',
        'config.privacyMode': 'Mode confidentialit√© ‚Üí Toujours utiliser le mod√®le local',
        'config.privacyModeDesc': 'Lorsque activ√©, toutes les requ√™tes sont trait√©es localement',
        'config.complexityThreshold': 'Seuil de complexit√© ‚Üí Cloud si score > 7/10',
        'config.fallbackOnError': 'Secours en erreur ‚Üí Basculer vers le fournisseur de secours',
        'config.forceLocal': 'Forcer local ‚Üí Toujours utiliser le local (mode hors-ligne)',
        'config.complexityWeights': 'Poids de Scoring de Complexit√©',
        'config.reasoning': 'N√©cessite Raisonnement',
        'config.multiStep': 'T√¢che Multi-√©tapes',
        'config.domainSpecific': 'Sp√©cifique au Domaine',
        'config.personalData': 'Contient Donn√©es Personnelles',
        'config.activeLocalModel': 'Mod√®le Local Actif',
        'config.installedModels': 'Mod√®les Install√©s',
        'config.noInstalledModels': 'Aucun mod√®le install√©',
        'config.notConnected': 'Non connect√©',
        'config.configure': 'Configurer',
        'config.reset': 'R√©initialiser',
        'logs.title': 'Journaux d\'Activit√©',
        'logs.filter': 'Filtrer',
        'logs.filterAll': 'Tous les Niveaux',
        'logs.export': 'Exporter CSV',
        'logs.clear': 'Tout Effacer',
        'logs.search': 'Rechercher dans les journaux...',
        'status.ready': 'Pr√™t',
        'status.error': 'Erreur',
        'status.loading': 'Chargement...',
        'status.valid': 'Valide',
        'status.invalid': 'Invalide',
        'model.ram.any': 'Fonctionne sur tout appareil',
        'model.ram.4gb': 'N√©cessite 4 Go+ RAM',
        'model.ram.8gb': 'N√©cessite 8 Go+ RAM / GPU recommand√©',
        'model.ram.gpu': 'GPU obligatoire'
      }
    };

    // ===== CONFIG MANAGER (IndexedDB) =====
    class ConfigManager {
      constructor() {
        this.dbName = 'browserfly-config';
        this.version = 1;
        this.db = null;
      }

      async init() {
        return new Promise((resolve, reject) => {
          const req = indexedDB.open(this.dbName, this.version);
          req.onupgradeneeded = (e) => {
            const db = e.target.result;
            if (!db.objectStoreNames.contains('config')) {
              db.createObjectStore('config', { keyPath: 'key' });
            }
            if (!db.objectStoreNames.contains('models')) {
              db.createObjectStore('models', { keyPath: 'id' });
            }
            if (!db.objectStoreNames.contains('logs')) {
              db.createObjectStore('logs', { keyPath: 'id' });
            }
          };
          req.onsuccess = (e) => {
            this.db = e.target.result;
            resolve(this);
          };
          req.onerror = () => reject(req.error);
        });
      }

      async get(key) {
        return new Promise((resolve) => {
          const tx = this.db.transaction('config', 'readonly');
          const req = tx.objectStore('config').get(key);
          req.onsuccess = () => resolve(req.result?.value ?? null);
          req.onerror = () => resolve(null);
        });
      }

      async set(key, value) {
        return new Promise((resolve, reject) => {
          const tx = this.db.transaction('config', 'readwrite');
          tx.objectStore('config').put({ key, value, updatedAt: Date.now() });
          tx.oncomplete = resolve;
          tx.onerror = () => reject(tx.error);
        });
      }

      async delete(key) {
        return new Promise((resolve, reject) => {
          const tx = this.db.transaction('config', 'readwrite');
          tx.objectStore('config').delete(key);
          tx.oncomplete = resolve;
          tx.onerror = () => reject(tx.error);
        });
      }

      async getAll() {
        return new Promise((resolve) => {
          const tx = this.db.transaction('config', 'readonly');
          const req = tx.objectStore('config').getAll();
          req.onsuccess = () => {
            const result = {};
            req.result.forEach(item => result[item.key] = item.value);
            resolve(result);
          };
          req.onerror = () => resolve({});
        });
      }
    }

    // ===== ACTIVITY LOGGER =====
    class ActivityLogger {
      constructor(configManager) {
        this.config = configManager;
        this.maxLogs = 10000;
        this.listeners = [];
      }

      async log(action, details = {}, level = 'info') {
        const entry = {
          id: crypto.randomUUID(),
          timestamp: Date.now(),
          isoTime: new Date().toISOString(),
          level,
          action,
          details,
          source: 'browserfly-core'
        };

        const logs = await this.config.get('activity_logs') || [];
        logs.unshift(entry);
        if (logs.length > this.maxLogs) logs.splice(this.maxLogs);
        await this.config.set('activity_logs', logs);

        window.dispatchEvent(new CustomEvent('bf:log', { detail: entry }));
        this.listeners.forEach(cb => cb(entry));

        return entry;
      }

      async getLogs(filters = {}) {
        let logs = await this.config.get('activity_logs') || [];

        if (filters.level) {
          logs = logs.filter(l => l.level === filters.level);
        }
        if (filters.search) {
          const search = filters.search.toLowerCase();
          logs = logs.filter(l => 
            l.action.toLowerCase().includes(search) ||
            JSON.stringify(l.details).toLowerCase().includes(search)
          );
        }
        if (filters.from) {
          const fromTime = new Date(filters.from).getTime();
          logs = logs.filter(l => l.timestamp >= fromTime);
        }
        if (filters.to) {
          const toTime = new Date(filters.to).getTime() + 86400000;
          logs = logs.filter(l => l.timestamp <= toTime);
        }

        return logs;
      }

      async clear() {
        await this.config.set('activity_logs', []);
        await this.log('LOGS_CLEARED', {}, 'info');
      }

      async exportCSV() {
        const logs = await this.config.get('activity_logs') || [];
        const headers = ['Timestamp', 'Level', 'Action', 'Details'];
        const rows = logs.map(l => [
          l.isoTime,
          l.level,
          l.action,
          JSON.stringify(l.details)
        ]);
        const csv = [headers.join(','), ...rows.map(r => r.map(v => `"${v}"`).join(','))].join('\n');
        return csv;
      }

      onLog(callback) {
        this.listeners.push(callback);
        return () => {
          const idx = this.listeners.indexOf(callback);
          if (idx > -1) this.listeners.splice(idx, 1);
        };
      }
    }

    // ===== PROVIDER CONFIGURATIONS =====
    const PROVIDERS = {
      groq: {
        name: 'Groq',
        icon: '‚ö°',
        color: '#F55036',
        baseUrl: 'https://api.groq.com/openai/v1',
        modelsEndpoint: '/models',
        headers: (key) => ({ 'Authorization': `Bearer ${key}` }),
        parseModels: (data) => data.data?.map(m => ({
          id: m.id,
          name: m.id,
          created: m.created,
          owned_by: m.owned_by,
          context_window: m.context_window || 'N/A',
          type: 'cloud',
          provider: 'groq',
          capabilities: ['chat', 'fast'],
          speed: 'ultra-fast'
        })) || []
      },
      kimi: {
        name: 'Moonshot/Kimi',
        icon: 'üåô',
        color: '#6C63FF',
        baseUrl: 'https://api.moonshot.ai/v1',
        modelsEndpoint: '/models',
        headers: (key) => ({ 'Authorization': `Bearer ${key}` }),
        parseModels: (data) => data.data?.map(m => ({
          id: m.id,
          name: m.id,
          type: 'cloud',
          provider: 'kimi',
          capabilities: ['chat', 'reasoning'],
          context_window: m.id.includes('128k') ? 128000 : m.id.includes('256k') ? 256000 : 32000
        })) || [],
        defaultModels: [
          { id: 'kimi-k2-0711-preview', name: 'Kimi K2 0711', context_window: 128000, capabilities: ['chat', 'reasoning', 'fast'], provider: 'kimi' },
          { id: 'kimi-k2-0905-preview', name: 'Kimi K2 0905', context_window: 256000, capabilities: ['chat', 'reasoning', 'long-context'], provider: 'kimi' },
          { id: 'kimi-k2-thinking', name: 'Kimi K2 Thinking', context_window: 128000, capabilities: ['chat', 'reasoning', 'deep-thinking'], provider: 'kimi' },
          { id: 'moonshot-v1-8k', name: 'Moonshot v1 8k', context_window: 8192, capabilities: ['chat', 'fast'], provider: 'kimi' },
          { id: 'moonshot-v1-32k', name: 'Moonshot v1 32k', context_window: 32000, capabilities: ['chat'], provider: 'kimi' },
          { id: 'moonshot-v1-128k', name: 'Moonshot v1 128k', context_window: 128000, capabilities: ['chat', 'long-context'], provider: 'kimi' }
        ]
      },
      openai: {
        name: 'OpenAI',
        icon: 'ü§ñ',
        color: '#10A37F',
        baseUrl: 'https://api.openai.com/v1',
        modelsEndpoint: '/models',
        headers: (key) => ({ 'Authorization': `Bearer ${key}` }),
        parseModels: (data) => {
          const relevant = ['gpt-4o', 'gpt-4o-mini', 'gpt-4-turbo', 'o1', 'o1-mini', 'o3-mini', 'gpt-4'];
          return data.data?.filter(m => relevant.some(r => m.id.includes(r))).map(m => {
            const caps = ['chat'];
            if (m.id.includes('vision') || m.id.includes('4o')) caps.push('vision');
            if (m.id.startsWith('o')) caps.push('reasoning');
            return {
              id: m.id,
              name: m.id,
              type: 'cloud',
              provider: 'openai',
              capabilities: caps,
              context_window: m.id.includes('mini') ? 128000 : 128000
            };
          }) || [];
        }
      },
      anthropic: {
        name: 'Anthropic',
        icon: 'üÖ∞Ô∏è',
        color: '#D4A574',
        baseUrl: 'https://api.anthropic.com/v1',
        modelsEndpoint: null,
        headers: (key) => ({ 'x-api-key': key, 'anthropic-version': '2023-06-01' }),
        parseModels: () => [],
        defaultModels: [
          { id: 'claude-opus-4-6', name: 'Claude Opus 4.6', context_window: 200000, capabilities: ['chat', 'reasoning', 'code', 'long-context'], provider: 'anthropic', cost: '$15/M input' },
          { id: 'claude-sonnet-4-6', name: 'Claude Sonnet 4.6', context_window: 200000, capabilities: ['chat', 'reasoning', 'code', 'long-context'], provider: 'anthropic', cost: '$3/M input' },
          { id: 'claude-haiku-4-5', name: 'Claude Haiku 4.5', context_window: 200000, capabilities: ['chat', 'fast', 'long-context'], provider: 'anthropic', cost: '$0.25/M input' }
        ]
      },
      google: {
        name: 'Google Gemini',
        icon: 'üî∑',
        color: '#4285F4',
        baseUrl: 'https://generativelanguage.googleapis.com/v1beta',
        modelsEndpoint: '/models',
        headers: () => ({}),
        parseModels: (data, key) => {
          return data.models?.filter(m => m.name.includes('gemini')).map(m => ({
            id: m.name.replace('models/', ''),
            name: m.displayName || m.name,
            type: 'cloud',
            provider: 'google',
            capabilities: m.supportedGenerationMethods?.includes('generateContent') ? ['chat', 'vision'] : ['chat'],
            context_window: m.inputTokenLimit || 'N/A'
          })) || [];
        }
      },
      mistral: {
        name: 'Mistral',
        icon: 'üå™Ô∏è',
        color: '#FF7000',
        baseUrl: 'https://api.mistral.ai/v1',
        modelsEndpoint: '/models',
        headers: (key) => ({ 'Authorization': `Bearer ${key}` }),
        parseModels: (data) => data.data?.map(m => ({
          id: m.id,
          name: m.name || m.id,
          type: 'cloud',
          provider: 'mistral',
          capabilities: ['chat', 'code'],
          context_window: m.max_context_length || 'N/A'
        })) || []
      },
      together: {
        name: 'Together AI',
        icon: 'üîó',
        color: '#FF6B9D',
        baseUrl: 'https://api.together.xyz/v1',
        modelsEndpoint: '/models',
        headers: (key) => ({ 'Authorization': `Bearer ${key}` }),
        parseModels: (data) => data?.filter(m => m.type === 'chat' || m.type === 'language').map(m => ({
          id: m.id,
          name: m.name || m.id,
          type: 'cloud',
          provider: 'together',
          capabilities: m.type === 'chat' ? ['chat'] : ['completion'],
          context_window: m.context_length || 'N/A'
        })) || []
      },
      cohere: {
        name: 'Cohere',
        icon: 'üìä',
        color: '#D6A5D4',
        baseUrl: 'https://api.cohere.com/v1',
        modelsEndpoint: '/models',
        headers: (key) => ({ 'Authorization': `Bearer ${key}`, 'Content-Type': 'application/json' }),
        parseModels: (data) => data.models?.map(m => ({
          id: m.name,
          name: m.name,
          type: 'cloud',
          provider: 'cohere',
          capabilities: ['chat', 'embedding'],
          context_window: m.context_length || 'N/A'
        })) || []
      }
    };

    // ===== RECOMMENDED LOCAL MODELS =====
    const RECOMMENDED_LOCAL_MODELS = [
      {
        id: 'Qwen/Qwen2.5-0.5B-Instruct',
        name: 'Qwen2.5 0.5B Instruct',
        size: '~1GB',
        ram: '2GB',
        speed: 'Very Fast',
        use: 'Quick tasks, mobile-friendly',
        tags: ['Chat', 'Fast', 'Tiny'],
        task: 'text-generation',
        capabilities: ['chat', 'fast']
      },
      {
        id: 'microsoft/phi-2',
        name: 'Microsoft Phi-2',
        size: '~1.5GB',
        ram: '3GB',
        speed: 'Fast',
        use: 'Coding, reasoning',
        tags: ['Chat', 'Code', 'Fast'],
        task: 'text-generation',
        capabilities: ['chat', 'code', 'fast']
      },
      {
        id: 'TinyLlama/TinyLlama-1.1B-Chat-v1.0',
        name: 'TinyLlama 1.1B Chat',
        size: '~600MB',
        ram: '2GB',
        speed: 'Ultra Fast',
        use: 'Edge devices, offline',
        tags: ['Chat', 'Fast', 'Tiny'],
        task: 'text-generation',
        capabilities: ['chat', 'fast']
      },
      {
        id: 'Qwen/Qwen2.5-3B-Instruct',
        name: 'Qwen2.5 3B Instruct',
        size: '~2GB',
        ram: '4GB',
        speed: 'Fast',
        use: 'Balanced performance',
        tags: ['Chat', 'Code', 'Balanced'],
        task: 'text-generation',
        capabilities: ['chat', 'code']
      },
      {
        id: 'mistralai/Mistral-7B-Instruct-v0.3',
        name: 'Mistral 7B Instruct',
        size: '~4GB',
        ram: '8GB',
        speed: 'Medium',
        use: 'High quality outputs',
        tags: ['Chat', 'Code', 'Quality'],
        task: 'text-generation',
        capabilities: ['chat', 'code', 'long-context']
      },
      {
        id: 'openai/whisper-tiny',
        name: 'Whisper Tiny',
        size: '~150MB',
        ram: '1GB',
        speed: 'Ultra Fast',
        use: 'Speech to text offline',
        tags: ['Audio', 'STT', 'Tiny'],
        task: 'automatic-speech-recognition',
        capabilities: ['audio', 'fast']
      },
      {
        id: 'openai/whisper-small',
        name: 'Whisper Small',
        size: '~450MB',
        ram: '2GB',
        speed: 'Fast',
        use: 'Better speech recognition',
        tags: ['Audio', 'STT', 'Fast'],
        task: 'automatic-speech-recognition',
        capabilities: ['audio', 'fast']
      }
    ];

    // ===== DEFAULT SOUL FILE =====
    const DEFAULT_SOUL_FILE = {
      name: "Fly",
      version: "1.0",
      created: Date.now(),
      identity: {
        personality: "Helpful, efficient, privacy-focused AI agent living in your browser",
        language: "auto",
        tone: "professional"
      },
      goals: [
        "Assist user with tasks efficiently",
        "Protect user privacy by preferring local processing",
        "Learn from interactions"
      ],
      values: ["privacy", "efficiency", "transparency", "honesty"],
      memory: {
        maxEntries: 1000,
        retentionDays: 30,
        indexingEnabled: true
      }
    };

    // ===== GRAVITATIONAL MEMORY (RAG BOOSTER) =====
    class GravitationalBit {
      constructor(n_max = 15) {
        this.n_max = n_max;
        this.states = this._initStates();
      }
      _initStates() {
        const s = [];
        for (let n = 1; n <= this.n_max; n++)
          for (let l = 0; l < n; l++)
            for (let m = -l; m <= l; m++)
              s.push({ n, l, m, occupied: false, energy: -13.6 / (n * n), phase: 0 });
        return s;
      }
      get capacity() { return this.states.length; }
      encode(bits) {
        for (let i = 0; i < Math.min(bits.length, this.states.length); i++)
          this.states[i].occupied = bits[i] === 1;
      }
      decode() { return this.states.map(s => s.occupied ? 1 : 0); }
    }

    class GravitationalMemory {
      constructor(configManager, chunkSize = 300) {
        this.config = configManager;
        this.chunkSize = chunkSize;
        this._keyPrefix = 'gmem:';
      }
      async store(key, text) {
        const chunks = this._split(text);
        const entry = {
          key, text, storedAt: Date.now(),
          chunks: chunks.map((c, i) => ({
            index: i, text: c,
            hash: this._hash(c),
            keywords: this._keywords(c)
          }))
        };
        await this.config.set(this._keyPrefix + key, entry);
        return entry;
      }
      async retrieve(query, topK = 5) {
        const qKw = this._keywords(query);
        const results = [];
        try {
          const tx = this.config.db.transaction('config', 'readonly');
          const store = tx.objectStore('config');
          const req = store.openCursor();
          await new Promise((res) => {
            req.onsuccess = e => {
              const cursor = e.target.result;
              if (!cursor) { res(); return; }
              if (cursor.key.startsWith && cursor.key.startsWith(this._keyPrefix)) {
                const entry = cursor.value?.value;
                if (entry?.chunks) {
                  for (const chunk of entry.chunks) {
                    const score = chunk.keywords.filter(w => qKw.includes(w)).length;
                    if (score > 0) results.push({ text: chunk.text, score });
                  }
                }
              }
              cursor.continue();
            };
            req.onerror = res;
          });
        } catch(e) { /* IndexedDB not ready yet */ }
        return results.sort((a,b) => b.score - a.score).slice(0, topK).map(r => r.text);
      }
      async delete(key) { await this.config.delete(this._keyPrefix + key); }
      _split(text) {
        const words = text.split(/\s+/);
        const chunks = [];
        for (let i = 0; i < words.length; i += this.chunkSize)
          chunks.push(words.slice(i, i + this.chunkSize).join(' '));
        return chunks;
      }
      _keywords(text) {
        const stop = new Set(['the','a','an','is','are','was','were','to','of','in','on','at','for','with','this','that','it','be','as','by','from','or','and','but','not','le','la','les','de','du','des','un','une','en','et','ou','pour','dans','sur','par','est','sont','avec','sans','plus','que','qui','ce','se','ne','je','tu','il','nous','vous','ils','elle','elles']);
        return text.toLowerCase().replace(/[^a-z0-9√†√¢√©√®√™√´√Æ√Ø√¥√π√ª√º√ß\s]/g,'').split(/\s+/).filter(w => w.length > 3 && !stop.has(w));
      }
      _hash(str) {
        let h = 0;
        for (let i = 0; i < str.length; i++) { h = ((h << 5) - h) + str.charCodeAt(i); h |= 0; }
        return h.toString(16);
      }
    }

    // ===== WEB WORKERS (Task Router + Inference Engine ‚Äî inline Blob) =====
    const TASK_ROUTER_CODE = `
    self.onmessage = function(e) {
      const { task, config } = e.data;
      let complexity = 0, urgency = 0, privacy = 0;
      if (task.requiresReasoning) complexity += 4;
      if (task.multiStep) complexity += 3;
      if (task.domainSpecific) complexity += 3;
      complexity = Math.min(complexity, 10);
      if (task.realtime) urgency += 5;
      if (task.streaming) urgency += 3;
      urgency = Math.min(urgency, 10);
      if (task.containsPersonalData) privacy += 5;
      if (config && config.privacyMode) privacy += 5;
      privacy = Math.min(privacy, 10);
      let decision;
      if (privacy >= 8) decision = 'local';
      else if (complexity >= 7) decision = 'cloud';
      else if (complexity <= 3 && urgency >= 7) decision = 'local';
      else if (config && config.localModelReady && complexity <= 5) decision = 'local';
      else decision = 'cloud';
      self.postMessage({ decision, complexity, urgency, privacy });
    };
    `;

    const INFERENCE_WORKER_CODE = `
    self.onmessage = async function(e) {
      const { type, payload } = e.data;
      if (type === 'ping') { self.postMessage({ type: 'pong', status: 'ready' }); return; }
      if (type === 'infer') {
        self.postMessage({ type: 'start', model: payload.model });
        // Simulated inference (real: use ONNX Web / WebLLM here)
        await new Promise(r => setTimeout(r, 500 + Math.random() * 1000));
        self.postMessage({ type: 'result', text: '[Local model inference placeholder ‚Äî integrate ONNX/WebLLM]', model: payload.model, latency: Date.now() - payload.startTime });
      }
    };
    `;

    class WorkerManager {
      constructor() {
        this.taskRouter = null;
        this.inferenceEngine = null;
        this._initWorkers();
      }
      _initWorkers() {
        try {
          const routerBlob = new Blob([TASK_ROUTER_CODE], { type: 'application/javascript' });
          this.taskRouter = new Worker(URL.createObjectURL(routerBlob));

          const inferBlob = new Blob([INFERENCE_WORKER_CODE], { type: 'application/javascript' });
          this.inferenceEngine = new Worker(URL.createObjectURL(inferBlob));
          this.inferenceEngine.postMessage({ type: 'ping' });
        } catch(e) {
          console.warn('[Browserfly] Web Workers not available:', e.message);
        }
      }
      async route(task, config = {}) {
        if (!this.taskRouter) return 'cloud';
        return new Promise((resolve) => {
          const handler = (e) => { this.taskRouter.removeEventListener('message', handler); resolve(e.data.decision); };
          this.taskRouter.addEventListener('message', handler);
          this.taskRouter.postMessage({ task, config });
          setTimeout(() => resolve('cloud'), 500); // fallback
        });
      }
      async infer(model, prompt) {
        if (!this.inferenceEngine) return null;
        return new Promise((resolve) => {
          const startTime = Date.now();
          const handler = (e) => {
            if (e.data.type === 'result') {
              this.inferenceEngine.removeEventListener('message', handler);
              resolve(e.data);
            }
          };
          this.inferenceEngine.addEventListener('message', handler);
          this.inferenceEngine.postMessage({ type: 'infer', payload: { model, prompt, startTime } });
          setTimeout(() => resolve(null), 10000); // 10s timeout
        });
      }
      terminate() {
        this.taskRouter?.terminate();
        this.inferenceEngine?.terminate();
      }
    }

    // ===== MAIN APPLICATION =====
    class BrowserflyApp {
      constructor() {
        this.config = new ConfigManager();
        this.logger = new ActivityLogger(this.config);
        this.memory = new GravitationalMemory(this.config);
        this.workers = new WorkerManager();
        this.currentLang = 'en';
        this.currentTab = 'dashboard';
        this.models = {};
        this.installedModels = [];
        this.requestsChart = null;
        this.init();
      }

      async init() {
        await this.config.init();
        await this.loadLanguage();
        await this.logger.log('APP_INITIALIZED', { version: '1.0.0', workers: this.workers.taskRouter ? 'active' : 'unavailable' }, 'info');
        if (this.workers.taskRouter) {
          await this.logger.log('WORKERS_STARTED', { taskRouter: true, inferenceEngine: true }, 'success');
        }
        this.setupEventListeners();
        this.generateBackgroundButterflies();
        this.renderApiKeys();
        this.renderCloudProviders();
        this.renderRecommendedModels();
        this.loadSoulFile();
        this.updateStats();
        this.setupChart();
        this.loadLogs();
        this.updateAgentStatus();
        this.setupSliders();
      }

      setupEventListeners() {
        // Tab navigation
        document.querySelectorAll('.nav-btn').forEach(btn => {
          btn.addEventListener('click', () => this.switchTab(btn.dataset.tab));
        });

        // Mobile menu
        document.getElementById('mobileMenuBtn')?.addEventListener('click', () => {
          document.getElementById('headerNav').classList.toggle('open');
        });

        // Language toggle
        document.querySelectorAll('.lang-btn').forEach(btn => {
          btn.addEventListener('click', () => this.switchLanguage(btn.dataset.lang));
        });

        // Sub-tabs
        document.querySelectorAll('.sub-tab').forEach(tab => {
          tab.addEventListener('click', () => this.switchSubTab(tab));
        });

        // Log events
        window.addEventListener('bf:log', (e) => {
          this.addActivityItem(e.detail);
        });

        // Log filters
        document.getElementById('logLevelFilter')?.addEventListener('change', () => this.loadLogs());
        document.getElementById('logSearch')?.addEventListener('input', () => this.loadLogs());
        document.getElementById('logDateFrom')?.addEventListener('change', () => this.loadLogs());
        document.getElementById('logDateTo')?.addEventListener('change', () => this.loadLogs());

        // Export/Clear logs
        document.getElementById('exportLogs')?.addEventListener('click', () => this.exportLogs());
        document.getElementById('clearLogs')?.addEventListener('click', () => this.clearLogs());

        // Save routing config
        document.getElementById('saveRoutingConfig')?.addEventListener('click', () => this.saveRoutingConfig());

        // Save soul file
        document.getElementById('saveSoulFile')?.addEventListener('click', () => this.saveSoulFile());
        document.getElementById('resetSoulFile')?.addEventListener('click', () => this.resetSoulFile());

        // HF Search
        document.getElementById('hfSearchBtn')?.addEventListener('click', () => this.searchHFModels());
        document.getElementById('hfSearchInput')?.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') this.searchHFModels();
        });

        // Provider/model selects
        document.getElementById('primaryProvider')?.addEventListener('change', () => this.updateModelSelect('primary'));
        document.getElementById('fallbackProvider')?.addEventListener('change', () => this.updateModelSelect('fallback'));
      }

      setupSliders() {
        const sliders = ['reasoning', 'multiStep', 'domain', 'personal'];
        sliders.forEach(name => {
          const slider = document.getElementById(`${name}Weight`);
          const value = document.getElementById(`${name}Value`);
          if (slider && value) {
            slider.addEventListener('input', () => {
              value.textContent = `+${slider.value}`;
            });
          }
        });
      }

      generateBackgroundButterflies() {
        const container = document.getElementById('bgButterflies');
        if (!container) return;

        const butterflySvg = `
          <svg viewBox="0 0 200 160" xmlns="http://www.w3.org/2000/svg">
            <path d="M100,80 Q60,20 20,40 Q10,60 30,80 Q10,100 30,120 Q60,140 100,80" fill="currentColor" opacity="0.6"/>
            <path d="M100,80 Q140,20 180,40 Q190,60 170,80 Q190,100 170,120 Q140,140 100,80" fill="currentColor" opacity="0.6"/>
          </svg>
        `;

        for (let i = 1; i <= 12; i++) {
          const div = document.createElement('div');
          div.className = `bg-butterfly bf-${i}`;
          const colors = ['#6C63FF', '#00D4FF', '#FF6B9D'];
          div.style.color = colors[i % 3];
          div.innerHTML = butterflySvg;
          container.appendChild(div);
        }
      }

      async loadLanguage() {
        const saved = await this.config.get('language');
        this.currentLang = saved || 'en';
        this.applyLanguage();
      }

      switchLanguage(lang) {
        this.currentLang = lang;
        this.config.set('language', lang);
        this.applyLanguage();
        this.logger.log('LANGUAGE_CHANGED', { language: lang }, 'info');
      }

      applyLanguage() {
        document.querySelectorAll('.lang-btn').forEach(btn => {
          btn.classList.toggle('active', btn.dataset.lang === this.currentLang);
        });

        document.querySelectorAll('[data-i18n]').forEach(el => {
          const key = el.dataset.i18n;
          const translation = TRANSLATIONS[this.currentLang]?.[key] || TRANSLATIONS['en']?.[key] || key;
          el.textContent = translation;
        });

        document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
          const key = el.dataset.i18nPlaceholder;
          const translation = TRANSLATIONS[this.currentLang]?.[key] || TRANSLATIONS['en']?.[key] || key;
          el.placeholder = translation;
        });
      }

      t(key) {
        return TRANSLATIONS[this.currentLang]?.[key] || TRANSLATIONS['en']?.[key] || key;
      }

      switchTab(tabName) {
        this.currentTab = tabName;

        document.querySelectorAll('.nav-btn').forEach(btn => {
          btn.classList.toggle('active', btn.dataset.tab === tabName);
        });

        document.querySelectorAll('.tab-content').forEach(content => {
          content.classList.toggle('active', content.id === `${tabName}-tab`);
        });

        document.getElementById('headerNav')?.classList.remove('open');
        this.logger.log('TAB_SWITCHED', { tab: tabName }, 'debug');
      }

      switchSubTab(tabEl) {
        const parent = tabEl.closest('.panel, .tab-content');
        const subtabName = tabEl.dataset.subtab;

        parent.querySelectorAll('.sub-tab').forEach(t => t.classList.remove('active'));
        parent.querySelectorAll('.sub-tab-content').forEach(c => c.classList.remove('active'));

        tabEl.classList.add('active');
        const content = parent.querySelector(`#${subtabName}-subtab`);
        if (content) content.classList.add('active');
      }

      renderApiKeys() {
        const container = document.getElementById('apiKeysContainer');
        if (!container) return;

        container.innerHTML = Object.entries(PROVIDERS).map(([key, provider]) => `
          <div class="form-group" data-provider="${key}">
            <label class="form-label">${provider.icon} ${provider.name}</label>
            <div class="input-group">
              <input type="password" class="form-input api-key-input" data-provider="${key}" placeholder="API Key">
              <button class="btn btn-secondary btn-sm verify-key-btn" data-provider="${key}">${this.t('config.verify')}</button>
              <button class="btn btn-secondary btn-sm delete-key-btn" data-provider="${key}">${this.t('config.delete')}</button>
            </div>
            <span class="key-status" id="status-${key}"></span>
          </div>
        `).join('');

        // Load saved keys
        Object.keys(PROVIDERS).forEach(async key => {
          const saved = await this.config.get(`apikey_${key}`);
          if (saved) {
            const input = container.querySelector(`input[data-provider="${key}"]`);
            if (input) input.value = saved;
          }
        });

        // Add event listeners
        container.querySelectorAll('.verify-key-btn').forEach(btn => {
          btn.addEventListener('click', () => this.verifyApiKey(btn.dataset.provider));
        });

        container.querySelectorAll('.delete-key-btn').forEach(btn => {
          btn.addEventListener('click', () => this.deleteApiKey(btn.dataset.provider));
        });

        container.querySelectorAll('.api-key-input').forEach(input => {
          input.addEventListener('change', () => this.saveApiKey(input.dataset.provider, input.value));
        });
      }

      async saveApiKey(provider, key) {
        if (!key) return;
        await this.config.set(`apikey_${provider}`, key);
        await this.logger.log('API_KEY_SAVED', { provider }, 'info');
        this.updateStats();
      }

      async deleteApiKey(provider) {
        await this.config.delete(`apikey_${provider}`);
        const input = document.querySelector(`input[data-provider="${provider}"]`);
        if (input) input.value = '';
        const status = document.getElementById(`status-${provider}`);
        if (status) status.textContent = '';
        await this.logger.log('API_KEY_DELETED', { provider }, 'info');
        this.updateStats();
      }

      async verifyApiKey(provider) {
        const input = document.querySelector(`input[data-provider="${provider}"]`);
        const status = document.getElementById(`status-${provider}`);
        if (!input || !status) return;

        const key = input.value;
        if (!key) {
          status.textContent = this.t('status.invalid');
          status.style.color = 'var(--error)';
          return;
        }

        status.textContent = this.t('status.loading');
        status.style.color = 'var(--text-muted)';

        try {
          const config = PROVIDERS[provider];
          if (!config.modelsEndpoint) {
            status.textContent = this.t('status.valid');
            status.style.color = 'var(--success)';
            await this.logger.log('API_KEY_VERIFIED', { provider, status: 'valid' }, 'success');
            return;
          }

          const url = `${config.baseUrl}${config.modelsEndpoint}`;
          const headers = config.headers(key);
          if (provider === 'google') {
            const sep = url.includes('?') ? '&' : '?';
            const fullUrl = `${url}${sep}key=${key}`;
            const response = await fetch(fullUrl);
            if (response.ok) {
              status.textContent = this.t('status.valid');
              status.style.color = 'var(--success)';
              await this.logger.log('API_KEY_VERIFIED', { provider, status: 'valid' }, 'success');
            } else {
              throw new Error('Invalid key');
            }
          } else {
            const response = await fetch(url, { headers });
            if (response.ok) {
              status.textContent = this.t('status.valid');
              status.style.color = 'var(--success)';
              await this.logger.log('API_KEY_VERIFIED', { provider, status: 'valid' }, 'success');
            } else {
              throw new Error('Invalid key');
            }
          }
        } catch (err) {
          status.textContent = this.t('status.invalid');
          status.style.color = 'var(--error)';
          await this.logger.log('API_KEY_VERIFICATION_FAILED', { provider, error: err.message }, 'error');
        }
      }

      renderCloudProviders() {
        const container = document.getElementById('cloudProvidersContainer');
        if (!container) return;

        container.innerHTML = Object.entries(PROVIDERS).map(([key, provider]) => `
          <div class="provider-section" data-provider="${key}">
            <div class="provider-header">
              <div class="provider-name">
                <span class="provider-icon" style="background: ${provider.color}20; color: ${provider.color}">${provider.icon}</span>
                ${provider.name}
              </div>
              <div class="provider-status">
                <button class="btn btn-primary btn-sm fetch-models-btn" data-provider="${key}">
                  ${this.t('models.fetch')}
                </button>
              </div>
            </div>
            <div class="models-grid" id="models-${key}">
              <div class="empty-state">
                <div class="empty-state-icon">üîë</div>
                <div class="empty-state-title">${this.t('models.no_key')}</div>
              </div>
            </div>
          </div>
        `).join('');

        container.querySelectorAll('.fetch-models-btn').forEach(btn => {
          btn.addEventListener('click', () => this.fetchModels(btn.dataset.provider));
        });
      }

      async fetchModels(providerKey) {
        const provider = PROVIDERS[providerKey];
        const container = document.getElementById(`models-${providerKey}`);
        const btn = document.querySelector(`.fetch-models-btn[data-provider="${providerKey}"]`);

        const apiKey = await this.config.get(`apikey_${providerKey}`);
        if (!apiKey) {
          alert(`Please add your ${provider.name} API key in Configuration first.`);
          return;
        }

        btn.disabled = true;
        btn.textContent = this.t('models.fetching');
        container.innerHTML = '<div class="loading"><div class="spinner"></div> Loading...</div>';

        await this.logger.log('MODELS_FETCH_STARTED', { provider: providerKey }, 'info');

        try {
          let models = [];

          if (provider.defaultModels && !provider.modelsEndpoint) {
            models = provider.defaultModels;
          } else {
            const url = providerKey === 'google' 
              ? `${provider.baseUrl}${provider.modelsEndpoint}?key=${apiKey}`
              : `${provider.baseUrl}${provider.modelsEndpoint}`;
            const headers = provider.headers(apiKey);

            const response = await fetch(url, { headers });
            if (!response.ok) throw new Error(`HTTP ${response.status}`);

            const data = await response.json();
            models = provider.parseModels(data, apiKey);
          }

          this.models[providerKey] = models;
          this.renderModels(providerKey, models);
          await this.logger.log('MODELS_FETCHED', { provider: providerKey, count: models.length }, 'success');
          this.updateStats();
          this.updateProviderSelects();
        } catch (err) {
          container.innerHTML = `
            <div class="alert alert-error">
              Error fetching models: ${err.message}
            </div>
          `;
          await this.logger.log('MODELS_FETCH_FAILED', { provider: providerKey, error: err.message }, 'error');
        } finally {
          btn.disabled = false;
          btn.textContent = this.t('models.fetch');
        }
      }

      renderModels(providerKey, models) {
        const container = document.getElementById(`models-${providerKey}`);
        if (!container) return;

        if (models.length === 0) {
          container.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">üì≠</div>
              <div class="empty-state-title">No models found</div>
            </div>
          `;
          return;
        }

        container.innerHTML = models.map(model => `
          <div class="model-card" data-model="${model.id}">
            <div class="model-header">
              <span class="model-name">${model.name}</span>
              ${model.id === this.primaryModel ? '<span class="model-badge badge-primary">PRIMARY</span>' : ''}
              ${model.id === this.fallbackModel ? '<span class="model-badge badge-fallback">FALLBACK</span>' : ''}
            </div>
            <div class="model-meta">
              <div class="model-meta-row">
                <span class="model-meta-label">Provider:</span>
                <span class="model-meta-value">${PROVIDERS[providerKey].name}</span>
              </div>
              <div class="model-meta-row">
                <span class="model-meta-label">${this.t('models.context')}:</span>
                <span class="model-meta-value">${typeof model.context_window === 'number' ? model.context_window.toLocaleString() : model.context_window} tokens</span>
              </div>
              ${model.speed ? `
              <div class="model-meta-row">
                <span class="model-meta-label">${this.t('models.speed')}:</span>
                <span class="model-meta-value">${model.speed}</span>
              </div>
              ` : ''}
              ${model.cost ? `
              <div class="model-meta-row">
                <span class="model-meta-label">${this.t('models.cost')}:</span>
                <span class="model-meta-value">${model.cost}</span>
              </div>
              ` : ''}
            </div>
            <div class="model-capabilities">
              ${(model.capabilities || []).map(cap => `
                <span class="capability-tag cap-${cap}">${cap}</span>
              `).join('')}
            </div>
            <div class="model-actions">
              <button class="btn btn-primary btn-sm set-primary-btn" data-provider="${providerKey}" data-model="${model.id}">
                ${this.t('models.set_primary')}
              </button>
              <button class="btn btn-secondary btn-sm set-fallback-btn" data-provider="${providerKey}" data-model="${model.id}">
                ${this.t('models.set_fallback')}
              </button>
            </div>
          </div>
        `).join('');

        container.querySelectorAll('.set-primary-btn').forEach(btn => {
          btn.addEventListener('click', () => this.setPrimaryModel(btn.dataset.provider, btn.dataset.model));
        });

        container.querySelectorAll('.set-fallback-btn').forEach(btn => {
          btn.addEventListener('click', () => this.setFallbackModel(btn.dataset.provider, btn.dataset.model));
        });
      }

      async setPrimaryModel(provider, modelId) {
        this.primaryProvider = provider;
        this.primaryModel = modelId;
        await this.config.set('primary_provider', provider);
        await this.config.set('primary_model', modelId);
        await this.logger.log('PRIMARY_MODEL_SET', { provider, model: modelId }, 'success');
        this.updateAgentStatus();
        this.renderCloudProviders();
      }

      async setFallbackModel(provider, modelId) {
        this.fallbackProvider = provider;
        this.fallbackModel = modelId;
        await this.config.set('fallback_provider', provider);
        await this.config.set('fallback_model', modelId);
        await this.logger.log('FALLBACK_MODEL_SET', { provider, model: modelId }, 'success');
        this.updateAgentStatus();
        this.renderCloudProviders();
      }

      updateProviderSelects() {
        const primarySelect = document.getElementById('primaryProvider');
        const fallbackSelect = document.getElementById('fallbackProvider');
        if (!primarySelect || !fallbackSelect) return;

        const options = Object.entries(this.models).flatMap(([provider, models]) => 
          models.map(m => `<option value="${provider}:${m.id}">${PROVIDERS[provider].name} - ${m.name}</option>`)
        ).join('');

        primarySelect.innerHTML = '<option value="">Select Provider</option>' + options;
        fallbackSelect.innerHTML = '<option value="">Select Provider</option>' + options;
      }

      updateModelSelect(type) {
        const providerSelect = document.getElementById(`${type}Provider`);
        const modelSelect = document.getElementById(`${type}Model`);
        if (!providerSelect || !modelSelect) return;

        const value = providerSelect.value;
        if (!value) return;

        const [provider, modelId] = value.split(':');
        modelSelect.innerHTML = `<option value="${modelId}">${modelId}</option>`;
      }

      renderRecommendedModels() {
        const container = document.getElementById('recommendedModels');
        if (!container) return;

        container.innerHTML = RECOMMENDED_LOCAL_MODELS.map(model => `
          <div class="model-card">
            <div class="model-header">
              <span class="model-name">${model.name}</span>
              <span class="model-badge badge-local">LOCAL</span>
            </div>
            <div class="model-meta">
              <div class="model-meta-row">
                <span class="model-meta-label">Size:</span>
                <span class="model-meta-value">${model.size}</span>
              </div>
              <div class="model-meta-row">
                <span class="model-meta-label">RAM:</span>
                <span class="model-meta-value">${model.ram}</span>
              </div>
              <div class="model-meta-row">
                <span class="model-meta-label">Speed:</span>
                <span class="model-meta-value">${model.speed}</span>
              </div>
              <div class="model-meta-row">
                <span class="model-meta-label">Use:</span>
                <span class="model-meta-value">${model.use}</span>
              </div>
            </div>
            <div class="model-capabilities">
              ${model.tags.map(tag => `<span class="capability-tag">${tag}</span>`).join('')}
            </div>
            <div class="model-actions">
              <button class="btn btn-primary btn-sm download-model-btn" data-model="${model.id}">
                ${this.t('models.download')}
              </button>
            </div>
          </div>
        `).join('');

        container.querySelectorAll('.download-model-btn').forEach(btn => {
          btn.addEventListener('click', () => this.downloadModel(btn.dataset.model));
        });
      }

      async searchHFModels() {
        const query = document.getElementById('hfSearchInput')?.value || '';
        const task = document.getElementById('hfTaskFilter')?.value || '';
        const size = document.getElementById('hfSizeFilter')?.value || '';
        const container = document.getElementById('hfSearchResults');
        const hfToken = await this.config.get('apikey_huggingface') || '';

        if (!container) return;

        container.innerHTML = '<div class="loading"><div class="spinner"></div> Searching...</div>';

        try {
          const params = new URLSearchParams({
            search: query,
            sort: 'downloads',
            direction: '-1',
            limit: '20'
          });
          if (task) params.append('filter', task);

          const headers = {};
          if (hfToken) headers['Authorization'] = `Bearer ${hfToken}`;

          const response = await fetch(`https://huggingface.co/api/models?${params}`, { headers });
          if (!response.ok) throw new Error('Search failed');

          const data = await response.json();
          this.renderHFResults(data);
          await this.logger.log('HF_SEARCH', { query, results: data.length }, 'info');
        } catch (err) {
          container.innerHTML = `<div class="alert alert-error">Search failed: ${err.message}</div>`;
        }
      }

      renderHFResults(models) {
        const container = document.getElementById('hfSearchResults');
        if (!container) return;

        if (models.length === 0) {
          container.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">üîç</div>
              <div class="empty-state-title">No models found</div>
            </div>
          `;
          return;
        }

        container.innerHTML = `
          <div class="panel">
            <div class="panel-header">
              <h4 class="panel-title">üîç Search Results (${models.length})</h4>
            </div>
            <div class="models-grid">
              ${models.map(m => `
                <div class="model-card">
                  <div class="model-header">
                    <span class="model-name">${m.id.split('/').pop()}</span>
                    <span class="model-badge badge-local">LOCAL</span>
                  </div>
                  <div class="model-meta">
                    <div class="model-meta-row">
                      <span class="model-meta-label">Author:</span>
                      <span class="model-meta-value">${m.id.split('/')[0]}</span>
                    </div>
                    <div class="model-meta-row">
                      <span class="model-meta-label">Downloads:</span>
                      <span class="model-meta-value">${(m.downloads || 0).toLocaleString()}</span>
                    </div>
                    <div class="model-meta-row">
                      <span class="model-meta-label">Likes:</span>
                      <span class="model-meta-value">${(m.likes || 0).toLocaleString()}</span>
                    </div>
                  </div>
                  <div class="model-actions">
                    <button class="btn btn-primary btn-sm download-model-btn" data-model="${m.id}">
                      ${this.t('models.download')}
                    </button>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
        `;

        container.querySelectorAll('.download-model-btn').forEach(btn => {
          btn.addEventListener('click', () => this.downloadModel(btn.dataset.model));
        });
      }

      async downloadModel(modelId) {
        await this.logger.log('MODEL_DOWNLOAD_STARTED', { model: modelId }, 'info');

        const progressId = `progress-${Date.now()}`;
        const panel = document.createElement('div');
        panel.className = 'panel';
        panel.id = progressId;
        panel.innerHTML = `
          <div class="progress-header">
            <span>${this.t('models.downloading')} ${modelId.split('/').pop()}</span>
            <span class="progress-percent">0%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: 0%"></div>
          </div>
          <p style="font-size: 0.8rem; color: var(--text-muted); margin-top: 8px;">
            Storing in IndexedDB... (simulated)
          </p>
        `;

        document.body.appendChild(panel);

        // Simulate download progress
        let progress = 0;
        const interval = setInterval(async () => {
          progress += Math.random() * 15;
          if (progress >= 100) {
            progress = 100;
            clearInterval(interval);

            setTimeout(async () => {
              panel.remove();
              this.installedModels.push({ id: modelId, installedAt: Date.now() });
              await this.config.set('installed_models', this.installedModels);
              await this.logger.log('MODEL_DOWNLOAD_COMPLETED', { model: modelId }, 'success');
              this.updateStats();
                  this.renderInstalledModels();
                }, 500);
              }

              const fill = panel.querySelector('.progress-fill');
              const percent = panel.querySelector('.progress-percent');
              if (fill) fill.style.width = `${progress}%`;
              if (percent) percent.textContent = `${Math.round(progress)}%`;
            }, 300);
          }

          renderInstalledModels() {
            const container = document.getElementById('installedModelsList');
            if (!container) return;

            if (this.installedModels.length === 0) {
              container.innerHTML = `
                <div class="empty-state">
                  <div class="empty-state-icon">üì¶</div>
                  <div class="empty-state-title">${this.t('config.noInstalledModels')}</div>
                </div>
              `;
              return;
            }

            container.innerHTML = this.installedModels.map(m => `
              <div class="activity-item">
                <div class="activity-icon" style="background: rgba(0, 212, 255, 0.2);">üì¶</div>
                <div class="activity-content">
                  <div class="activity-text">${m.id}</div>
                  <div class="activity-time">${new Date(m.installedAt).toLocaleString()}</div>
                </div>
                <button class="btn btn-secondary btn-sm remove-model-btn" data-model="${m.id}">Remove</button>
              </div>
            `).join('');

            container.querySelectorAll('.remove-model-btn').forEach(btn => {
              btn.addEventListener('click', () => this.removeModel(btn.dataset.model));
            });
          }

          async removeModel(modelId) {
            this.installedModels = this.installedModels.filter(m => m.id !== modelId);
            await this.config.set('installed_models', this.installedModels);
            await this.logger.log('MODEL_REMOVED', { model: modelId }, 'info');
            this.renderInstalledModels();
            this.updateStats();
          }

          async loadSoulFile() {
            const saved = await this.config.get('soul_file');
            const soulFile = saved || DEFAULT_SOUL_FILE;
            const editor = document.getElementById('soulFileEditor');
            if (editor) {
              editor.value = JSON.stringify(soulFile, null, 2);
            }
          }

          async saveSoulFile() {
            const editor = document.getElementById('soulFileEditor');
            if (!editor) return;

            try {
              const soulFile = JSON.parse(editor.value);
              await this.config.set('soul_file', soulFile);
              await this.logger.log('SOUL_FILE_SAVED', {}, 'success');
              alert('Soul file saved successfully!');
            } catch (err) {
              alert('Invalid JSON: ' + err.message);
            }
          }

          async resetSoulFile() {
            const editor = document.getElementById('soulFileEditor');
            if (editor) {
              editor.value = JSON.stringify(DEFAULT_SOUL_FILE, null, 2);
            }
            await this.config.set('soul_file', DEFAULT_SOUL_FILE);
            await this.logger.log('SOUL_FILE_RESET', {}, 'info');
          }

          async saveRoutingConfig() {
            const config = {
              primaryProvider: document.getElementById('primaryProvider')?.value || '',
              fallbackProvider: document.getElementById('fallbackProvider')?.value || '',
              privacyMode: document.getElementById('privacyMode')?.checked || false,
              complexityThreshold: document.getElementById('complexityThreshold')?.checked || false,
              fallbackOnError: document.getElementById('fallbackOnError')?.checked || false,
              forceLocal: document.getElementById('forceLocal')?.checked || false,
              weights: {
                reasoning: parseInt(document.getElementById('reasoningWeight')?.value || 4),
                multiStep: parseInt(document.getElementById('multiStepWeight')?.value || 3),
                domain: parseInt(document.getElementById('domainWeight')?.value || 3),
                personal: parseInt(document.getElementById('personalWeight')?.value || 5)
              }
            };

            await this.config.set('routing_config', config);
            await this.logger.log('ROUTING_CONFIG_SAVED', config, 'success');
            this.updateAgentStatus();
            alert('Routing configuration saved!');
          }

          async updateAgentStatus() {
            const routing = await this.config.get('routing_config') || {};
            const primary = routing.primaryProvider ? routing.primaryProvider.split(':') : [this.primaryProvider, this.primaryModel];
            const fallback = routing.fallbackProvider ? routing.fallbackProvider.split(':') : [this.fallbackProvider, this.fallbackModel];

            const primaryEl = document.getElementById('agentPrimary');
            const fallbackEl = document.getElementById('agentFallback');
            const localEl = document.getElementById('agentLocal');
            const modeEl = document.getElementById('agentMode');
            const privacyEl = document.getElementById('agentPrivacy');

            if (primaryEl) {
              primaryEl.textContent = primary[0] && primary[1] 
                ? `${PROVIDERS[primary[0]]?.name || primary[0]}/${primary[1].split('/').pop()}` 
                : '‚Äî';
            }
            if (fallbackEl) {
              fallbackEl.textContent = fallback[0] && fallback[1] 
                ? `${PROVIDERS[fallback[0]]?.name || fallback[0]}/${fallback[1].split('/').pop()}` 
                : '‚Äî';
            }
            if (localEl) {
              const installed = this.installedModels[0];
              localEl.textContent = installed ? `${installed.id.split('/').pop()} [READY]` : '‚Äî';
            }
            if (modeEl) modeEl.textContent = routing.forceLocal ? 'Force Local' : routing.privacyMode ? 'Privacy Mode' : 'Auto-routing';
            if (privacyEl) privacyEl.textContent = routing.privacyMode || routing.forceLocal ? 'ON' : 'OFF';
          }

          async updateStats() {
            const config = await this.config.getAll();
            const apiKeys = Object.keys(config).filter(k => k.startsWith('apikey_')).length;
            const allModels = Object.values(this.models).flat().length;
            const installed = this.installedModels.length;
            const logs = await this.config.get('activity_logs') || [];
            const requests = logs.filter(l => l.action === 'CHAT_REQUEST' || l.action === 'MODELS_FETCHED').length;

            const statProviders = document.getElementById('statProviders');
            const statModels = document.getElementById('statModels');
            const statRequests = document.getElementById('statRequests');
            const statStorage = document.getElementById('statStorage');

            if (statProviders) statProviders.textContent = apiKeys;
            if (statModels) statModels.textContent = allModels + installed;
            if (statRequests) statRequests.textContent = requests;
            if (statStorage) {
              const storage = JSON.stringify(config).length / 1024;
              statStorage.textContent = `${storage.toFixed(1)} KB`;
            }
          }

          setupChart() {
            const ctx = document.getElementById('requestsChart');
            if (!ctx) return;

            const days = Array.from({ length: 14 }, (_, i) => {
              const d = new Date();
              d.setDate(d.getDate() - (13 - i));
              return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            });

            this.requestsChart = new Chart(ctx, {
              type: 'line',
              data: {
                labels: days,
                datasets: [
                  {
                    label: 'Local',
                    data: Array.from({ length: 14 }, () => Math.floor(Math.random() * 20)),
                    borderColor: '#6C63FF',
                    backgroundColor: 'rgba(108, 99, 255, 0.1)',
                    fill: true,
                    tension: 0.4
                  },
                  {
                    label: 'Cloud',
                    data: Array.from({ length: 14 }, () => Math.floor(Math.random() * 30)),
                    borderColor: '#00D4FF',
                    backgroundColor: 'rgba(0, 212, 255, 0.1)',
                    fill: true,
                    tension: 0.4
                  }
                ]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: {
                    labels: { color: '#E8E8FF' }
                  }
                },
                scales: {
                  x: {
                    ticks: { color: '#8888AA' },
                    grid: { color: 'rgba(108, 99, 255, 0.1)' }
                  },
                  y: {
                    ticks: { color: '#8888AA' },
                    grid: { color: 'rgba(108, 99, 255, 0.1)' }
                  }
                }
              }
            });
          }

          async loadLogs() {
            const filters = {
              level: document.getElementById('logLevelFilter')?.value || '',
              search: document.getElementById('logSearch')?.value || '',
              from: document.getElementById('logDateFrom')?.value || '',
              to: document.getElementById('logDateTo')?.value || ''
            };

            const logs = await this.logger.getLogs(filters);
            this.renderLogs(logs);
          }

          renderLogs(logs) {
            const container = document.getElementById('logsContainer');
            if (!container) return;

            if (logs.length === 0) {
              container.innerHTML = `
                <div class="empty-state">
                  <div class="empty-state-icon">üìã</div>
                  <div class="empty-state-title">${this.t('logs.empty')}</div>
                </div>
              `;
              return;
            }

            container.innerHTML = logs.slice(0, 100).map(log => `
              <div class="log-entry">
                <div class="log-level ${log.level}"></div>
                <div class="log-content">
                  <div class="log-time">${log.isoTime}</div>
                  <div class="log-action">${log.action}</div>
                  ${Object.keys(log.details).length > 0 ? `
                    <div class="log-details">${JSON.stringify(log.details)}</div>
                  ` : ''}
                </div>
              </div>
            `).join('');
          }

          addActivityItem(log) {
            const feed = document.getElementById('activityFeed');
            if (!feed) return;

            // Remove empty state if present
            const emptyState = feed.querySelector('.empty-state');
            if (emptyState) emptyState.remove();

            const icons = {
              'API_KEY_SAVED': 'üîë',
              'API_KEY_VERIFIED': '‚úÖ',
              'API_KEY_DELETED': 'üóëÔ∏è',
              'MODELS_FETCHED': 'üîç',
              'MODEL_DOWNLOAD_STARTED': '‚¨áÔ∏è',
              'MODEL_DOWNLOAD_COMPLETED': '‚úÖ',
              'PRIMARY_MODEL_SET': '‚≠ê',
              'FALLBACK_MODEL_SET': 'üîÅ',
              'ROUTING_CONFIG_SAVED': '‚öôÔ∏è',
              'SOUL_FILE_SAVED': '‚ú®',
              'LANGUAGE_CHANGED': 'üåê',
              'TAB_SWITCHED': 'üìë'
            };

            const item = document.createElement('div');
            item.className = 'activity-item';
            item.innerHTML = `
              <div class="activity-icon" style="background: rgba(108, 99, 255, 0.2);">${icons[log.action] || 'üìã'}</div>
              <div class="activity-content">
                <div class="activity-text">${log.action.replace(/_/g, ' ')}</div>
                <div class="activity-time">${new Date(log.timestamp).toLocaleTimeString()}</div>
              </div>
            `;

            feed.insertBefore(item, feed.firstChild);

            // Keep only last 10
            while (feed.children.length > 10) {
              feed.removeChild(feed.lastChild);
            }
          }

          async exportLogs() {
            const csv = await this.logger.exportCSV();
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `browserfly-logs-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            await this.logger.log('LOGS_EXPORTED', {}, 'info');
          }

          async clearLogs() {
            if (confirm('Are you sure you want to clear all logs?')) {
              await this.logger.clear();
              this.loadLogs();
            }
          }
        }

        // Initialize app
        const app = new BrowserflyApp();
  </script>
</body>
</html>
